(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{447:function(e,t,a){e.exports=a(938)},461:function(e,t,a){},463:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},464:function(e,t,a){},819:function(e,t){},938:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(49),o=a.n(i),s=a(28),c=(a(461),a(11)),l=a(12),u=a(14),p=a(13),d=a(15),m=(a(463),a(464),a(951)),h=a(952),f=a(20),g=a.n(f),v=a(949),b=a(52),E=a.n(b),y=a(4),S=a.n(y),w=a(3),C=a.n(w),x=a(38),O=a.n(x),k=a(19),T=a.n(k),j=a(53),D=a.n(j),N=a(60),P=a.n(N),A=a(63),I=a.n(A),L=a(304),_=a.n(L),M=a(74),R=a.n(M),B=a(91),F=a.n(B),U=a(56),W=a.n(U),q=a(17),z=a(40),H=a.n(z),G=a(57),V=a.n(G),J=a(16),Z=a(187),Y=a.n(Z),Q=a(133),$=a.n(Q),K=a(111),X=a.n(K),ee=a(88),te=a.n(ee),ae=a(166),ne=a.n(ae),re=a(148),ie=a.n(re),oe=a(301),se=a.n(oe),ce=a(302),le=a.n(ce),ue=a(130),pe=a.n(ue),de=a(421),me=a.n(de),he=a(64),fe=a.n(he),ge=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={top:!1,left:!1,bottom:!1,right:!1},a.handleDrawerClose=function(){a.setState({left:!1}),a.setState({toggle:!1})},a.toggleDrawer=function(e,t){return function(){a.setState(Object(J.a)({},e,t))}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.toggle!==this.state.toggle&&this.setState({left:e.toggle})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=(e.toggle,["/home","/addPatient","/addAsset"]),n=["/locationTracking","/contactTracing"],i=r.a.createElement("div",{className:t.list},r.a.createElement($.a,null,["Home","Add Patient","Add Asset"].map(function(e,n){return r.a.createElement(te.a,{button:!0,component:v.a,to:a[n],key:e},r.a.createElement(ne.a,null,0===n?r.a.createElement(se.a,null):n%2===0?r.a.createElement("div",{className:t.briefcaseIcon},r.a.createElement("i",{className:"fas fa-briefcase-medical"})):r.a.createElement(le.a,null)),r.a.createElement(ie.a,{primary:e}))}),r.a.createElement(te.a,{button:!0,component:v.a,to:"/addStaff",key:"Add Staff"},r.a.createElement(ne.a,{className:t.addStaffIcon},r.a.createElement("div",null,r.a.createElement(P.a,{className:t.addIcon}),r.a.createElement("div",{className:t.mdIcon},r.a.createElement("i",{className:"fas fa-user-md fa-sm"})))),r.a.createElement(ie.a,{primary:"Add Staff"}))),r.a.createElement(X.a,null),r.a.createElement($.a,null,["Location Tracking","Contact Tracing"].map(function(e,t){return r.a.createElement(te.a,{button:!0,component:v.a,to:n[t],key:e},r.a.createElement(ne.a,null,t%2===0?r.a.createElement(pe.a,null):r.a.createElement(me.a,null)),r.a.createElement(ie.a,{primary:e}))}))),o=r.a.createElement("div",{className:t.fullList},r.a.createElement($.a,null,["Home","Add Patient","Add Asset","Add Staff"].map(function(e,t){return r.a.createElement(te.a,{button:!0,key:e},r.a.createElement(ne.a,null,t%2===0?r.a.createElement(se.a,null):r.a.createElement(le.a,null)),r.a.createElement(ie.a,{primary:e}))})),r.a.createElement(X.a,null),r.a.createElement($.a,null,["Location Tracking","Contact Tracing"].map(function(e,t){return r.a.createElement(te.a,{button:!0,key:e},r.a.createElement(ne.a,null,t%2===0?r.a.createElement(pe.a,null):r.a.createElement("div",null,r.a.createElement(P.a,null),r.a.createElement("i",{className:"fas fa-user-md fa-sm"}))),r.a.createElement(ie.a,{primary:e}))})));return r.a.createElement("div",null,r.a.createElement(fe.a,{onClickAway:this.handleDrawerClose},r.a.createElement("div",null,r.a.createElement(Y.a,{open:this.state.left,onClose:this.toggleDrawer("left",!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer("left",!1),onKeyDown:this.toggleDrawer("left",!1)},i)),r.a.createElement(Y.a,{anchor:"top",open:this.state.top,onClose:this.toggleDrawer("top",!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer("top",!1),onKeyDown:this.toggleDrawer("top",!1)},o)),r.a.createElement(Y.a,{anchor:"bottom",open:this.state.bottom,onClose:this.toggleDrawer("bottom",!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer("bottom",!1),onKeyDown:this.toggleDrawer("bottom",!1)},o)),r.a.createElement(Y.a,{anchor:"right",open:this.state.right,onClose:this.toggleDrawer("right",!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer("right",!1),onKeyDown:this.toggleDrawer("right",!1)},i)))))}}]),t}(r.a.Component),ve=Object(q.withStyles)({list:{width:250},fullList:{width:"auto"},addStaffIcon:{marginRight:"14px"},addIcon:{width:".6em"},mdIcon:{marginLeft:"-.2em",fontSize:"1.3em",display:"inline"},briefcaseIcon:{fontSize:"1.2em",marginLeft:".2em"}})(ge),be=a(95),Ee=a.n(be),ye=a(18),Se=a.n(ye),we=a(43),Ce=a(303),xe=a.n(Ce),Oe=(a(939),a(586),a(589),xe.a.initializeApp({apiKey:"AIzaSyC0TRzBu4_nZx7aHsXysIE9fxD-9Dh-JQo",authDomain:"vital-simulator.firebaseapp.com",databaseURL:"https://vital-simulator.firebaseio.com",projectId:"vital-simulator",storageBucket:"vital-simulator.appspot.com",messagingSenderId:"657874416327"})),ke=xe.a.initializeApp({apiKey:"AIzaSyBhkxSRwaNi0JxGMiH_1eXITpz602Hvqp8",authDomain:"medicalportal-62857.firebaseapp.com",databaseURL:"https://medicalportal-62857.firebaseio.com",projectId:"medicalportal-62857",storageBucket:"",messagingSenderId:"210169025710"},"medicalPortal");Oe.auth().signInWithEmailAndPassword("admin@admin.com","password");Oe.storage();var Te=Oe.database().ref(),je=Te.child("ecg"),De=Te.child("heartrate"),Ne=ke.database().ref(),Pe=Ne.child("beaconCounter"),Ae=Ne.child("patientCounter"),Ie=Ne.child("assetCounter"),Le=Ne.child("staffCounter"),_e=Ne.child("fakeData"),Me=a(29),Re=a.n(Me),Be=function(e){return{type:"ADD_USERNAME",payload:e}},Fe=function(e){return{type:"ASSIGN_BEACON",payload:e}},Ue=function(e){return{type:"ASSIGN_DEVICES",payload:e}},We=function(e){return{type:"CONFIRM_TYPE",payload:e}},qe=function(e){return{type:"EDIT_PATIENT",payload:e}},ze=function(e){return{type:"FETCH_MAPS",payload:e}},He=function(e){return{type:"LOAD_MAP",payload:e}},Ge=function(e){return{type:"FETCH_DEVICES",payload:e}},Ve=function(e){return{type:"FETCH_DEVICE_LOCATIONS",payload:e}},Je=function(e){return function(){var t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("patients").push().set(e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Ze=function(e){return function(){var t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("patients/".concat(e.id)).remove();case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Ye=function(){return function(){var e=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ke.auth().signOut().then(function(){t({type:"SIGN_OUT_USER"})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Qe=function(){return function(){var e=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ke.auth().onAuthStateChanged(function(e){if(e){var a=ke.auth().currentUser;t({type:"ADD_USERNAME",payload:a.email}),t({type:"AUTH_USER"})}else t({type:"SIGN_OUT_USER"})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},$e=function(){return function(){var e=Object(we.a)(Se.a.mark(function e(t){var a,n;return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(a=new Date).setSeconds(a.getSeconds()-2),a=a.toISOString().substr(0,19),1e4,n={size:1e4,sort:[{timestamp:{order:"asc"}}],query:{bool:{must:[{range:{"@timestamp":{gte:a,lte:a}}}]}}},Re.a.get("http://137.132.165.139:9200/simulated-coordinates/_search?scroll=1m",{params:{source:JSON.stringify(n),source_content_type:"application/json"}}).then(function(e){e.data.hits.hits.length>0&&t({type:"FETCH_SIMULATION_COORDINATES",payload:e.data.hits.hits[0]._source})});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ke=function(e){return function(){var t=Object(we.a)(Se.a.mark(function t(a){var n,r,i,o,s;return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.startTime,r=e.endTime,n+=":00",r+=":00",i=e.contactDistance,o=e.name,"precomputed-".concat(o),1e4,a({type:"FETCHING_PROCESS"}),{size:1e4,sort:[{timestamp:{order:"asc"}}],query:{bool:{must:[{range:{"@timestamp":{gte:n,lte:r,time_zone:"+08:00"}}},{range:{distance:{lte:i}}}]}}},s={size:1e4,sort:[{timestamp:{order:"asc"}}],query:{bool:{must:[{range:{"@timestamp":{gte:n,lte:r,time_zone:"+08:00"}}}]}}},Re.a.get("http://137.132.165.139:9200/simulated-coordinates/_search?scroll=1m",{params:{source:JSON.stringify(s),source_content_type:"application/json"}}).then(function(t){var s=t.data.hits.hits,c={},l=[],u=0;s.forEach(function(e){var t=e._source;t.key=e._id,l.push(t),c[e._id]=u,u+=1});t.data.hits.total;Xe({scroll:"1m",scroll_id:t.data._scroll_id},l),n=encodeURI(n.replace("T"," ")),r=encodeURI(r.replace("T"," "));var p="http://137.132.165.139:5001/contacts?beacon=".concat(o,"&distance=").concat(i,"&startTime=").concat(n,"&endTime=").concat(r);Re.a.get(p).then(function(t){a({type:"UPDATE_TRACE_DETAILS",payload:e}),a({type:"FETCH_CONTACT_TRACE",payload:l}),a({type:"FETCH_FILTER_TRACE",payload:t.data}),a({type:"FETCHING_DONE"})}).catch(function(e){a({type:"FETCHING_DONE"})})});case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()};function Xe(e,t){Re.a.get("http://137.132.165.139:9200/_search/scroll",{params:{source:JSON.stringify(e),source_content_type:"application/json"}}).then(function(e){e.data.hits.hits.forEach(function(e){var a=e._source;a.key=e._id,t.push(a)});var a={scroll:"1m",scroll_id:e.data._scroll_id};e.data.hits.hits.length>0&&Xe(a,t)})}var et=function(){return function(){var e=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:je.on("value",function(e){t({type:"FETCH_ECG_VITALS",payload:e.val()})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},tt=function(e){return function(){var t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:je.child(e).on("value",function(e){a({type:"FETCH_ECG_VITALS",payload:e.val()})});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},at=function(){return function(){var e=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:De.on("value",function(e){t({type:"FETCH_HEARTRATE_VITALS",payload:e.val()})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},nt=function(e){return function(){var t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:De.child(e).on("value",function(e){a({type:"FETCH_HEARTRATE_VITALS",payload:e.val()})});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},rt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.handleChange=function(e){a.setState({auth:e.target.checked})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleLogOut=function(){a.setState({anchorEl:null}),a.props.signOutUser()},a.renderUsername=function(){var e=a.state.username;if(null!=e){var t=(e=e.charAt(0).toUpperCase()+e.slice(1)).split("@");e=t[0]}return e},a.state={username:a.props.username,anchorEl:null,auth:!0,drawer:!1,isAuthenticating:!0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.username!=e.username&&this.setState({username:this.props.username}),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.auth,i=Boolean(a);return this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:e.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"},className:e.AppBar},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:e.grow,style:{color:"black"}},"Home"),n&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":i?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(ve,{toggle:this.state.drawer}),r.a.createElement(S.a,{container:!0,className:e.root},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(S.a,{className:e.title,container:!0,spacing:16,alignItems:"center",direction:"row",justify:"center"},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0,className:e.title},"Welcome ",this.renderUsername(),"!"))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(S.a,{container:!0,spacing:40,alignItems:"center",direction:"row",justify:"center"},r.a.createElement(S.a,{item:!0},r.a.createElement(g.a,{component:v.a,to:"/addPatient",variant:"outlined",color:"primary",className:e.addButton},r.a.createElement(P.a,null)," Patient")),r.a.createElement(S.a,{item:!0},r.a.createElement(g.a,{component:v.a,to:"/addAsset",variant:"outlined",color:"primary",className:e.addButton},r.a.createElement(P.a,null)," Asset")),r.a.createElement(S.a,{item:!0},r.a.createElement(g.a,{component:v.a,to:"/addStaff",variant:"outlined",color:"primary",className:e.addButton},r.a.createElement(P.a,null)," Staff")))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(S.a,{container:!0,className:e.cardsFlex,spacing:40,alignItems:"center",direction:"row",justify:"center"},r.a.createElement(S.a,{item:!0},r.a.createElement(I.a,{className:e.card},r.a.createElement(_.a,{component:v.a,to:"/locationTracking"},r.a.createElement(F.a,{component:"img",alt:"Contemplative Reptile",className:e.media,height:"180",image:"img/LocationTracking.jpg",title:"Location Tracking"}),r.a.createElement(R.a,null,r.a.createElement(C.a,{gutterBottom:!0,variant:"h6",component:"h2"},"Location & Status Tracking"),r.a.createElement(C.a,{component:"p"},"Shows locations and statuses of patients, assets and staff"))))),r.a.createElement(S.a,{item:!0},r.a.createElement(I.a,{className:e.card},r.a.createElement(_.a,{component:v.a,to:"/contactTracing"},r.a.createElement(F.a,{component:"img",alt:"Contemplative Reptile",className:e.media,height:"180",image:"img/ContactTracing.jpg",title:"Contact Tracing"}),r.a.createElement(R.a,null,r.a.createElement(C.a,{gutterBottom:!0,variant:"h6",component:"h2"},"Contact Tracing"),r.a.createElement(C.a,{component:"p"},"Identify contact between the infected and other patients")))))))))}}]),t}(n.Component),it=Object(s.b)(function(e){return{username:e.username,authenticated:e.authenticated,isAuthenticating:e.isAuthenticating}},function(e){return{signOutUser:function(t){return e(Ye())},verifyAuth:function(t){return e(Qe())}}})(rt),ot=Object(q.withStyles)({root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},buttons:{display:"flex",width:"450px",margin:"auto",marginTop:"1rem",justifyContent:"space-evenly"},addButton:{paddingLeft:"8px"},card:{maxWidth:345},lander:{marginTop:"1.5rem"},media:{objectFit:"cover"},cardsFlex:{paddingTop:"3em"},title:{paddingBottom:".3em",paddingTop:"1em"},AppBar:{borderBottom:"1px solid #f2f3f3"}})(it),st=a(26),ct=a.n(st),lt=a(42),ut=a.n(lt),pt=a(37),dt=a.n(pt),mt=a(422),ht=a.n(mt),ft=a(224),gt=a.n(ft),vt=a(424),bt=a.n(vt),Et=a(423),yt=a.n(Et),St=a(76),wt=a.n(St),Ct=a(6),xt=a.n(Ct),Ot=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).renderAuthenticationError=function(){return a.props.autherror?r.a.createElement(C.a,{variant:"subtitle1",style:{color:"red"}}," ",a.props.autherror," "):r.a.createElement("div",null)},a.handleSubmit=function(e){e.preventDefault(),clearTimeout(a.timer);a.state.username;var t={email:a.state.username,password:a.state.password};a.props.signInUser(t)},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleClickShowPassword=function(){a.setState(function(e){return{showPassword:!e.showPassword}})},a.state={username:"",password:"",loading:!1,query:"idle",error:"",showPassword:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"componentDidUpdate",value:function(e,t){this.props.authenticated&&this.props.history.push("/home")}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.background},r.a.createElement("div",{className:t.overlay},r.a.createElement(O.a,{className:t.toolbar},r.a.createElement("img",{src:"img/nuslogo.png",className:t.nuslogo}),r.a.createElement("img",{src:"img/nuhlogo.png",className:t.nuhlogo})),r.a.createElement(S.a,{container:!0,justify:"center",direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:t.layout},r.a.createElement(ut.a,{className:t.paper,elevation:10},r.a.createElement(gt.a,{className:t.avatar},r.a.createElement(ht.a,null)),r.a.createElement(C.a,{variant:"h5",gutterBottom:!0},"Login"),r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"Medical Portal"),this.renderAuthenticationError(),r.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Email",placeholder:"Email",autoComplete:"email",required:!0,variant:"outlined",fullWidth:!0,className:t.textField,onChange:function(t){return e.setState({username:t.target.value})}})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{type:this.state.showPassword?"text":"password",label:"Password",placeholder:"Password",required:!0,variant:"outlined",className:xt()(t.margin,t.textField),onChange:function(t){return e.setState({password:t.target.value})},InputProps:{endAdornment:r.a.createElement(wt.a,{position:"end"},r.a.createElement(T.a,{"aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?r.a.createElement(yt.a,null):r.a.createElement(bt.a,null)))}})),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},r.a.createElement(g.a,{type:"submit",variant:"contained",color:"primary"},"Submit")))))))))}}]),t}(n.Component),kt=Object(s.b)(function(e){return{authenticated:e.authenticated,autherror:e.autherror,isAuthenticating:e.isAuthenticating}},function(e){return{addUsername:function(t){return e(Be(t))},signInUser:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.auth().signInWithEmailAndPassword(e.email,e.password).then(function(e){a({type:"AUTH_USER"})}).catch(function(e){a({type:"AUTH_ERROR",payload:e})});case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},verifyAuth:function(t){return e(Qe())}}})(Ot),Tt=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},layout:Object(J.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},form:{width:"100%",marginTop:e.spacing.unit},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},background:{backgroundImage:"url(/img/NUH.jpg)",backgroundSize:"cover",minHeight:"100vh",backgroundPosition:"center center"},overlay:{backgroundColor:"rgba(255, 255, 255, 0.1)",minHeight:"100vh"},nuslogo:{maxHeight:"7vh",paddingRight:"1em"},nuhlogo:{maxHeight:"7vh"},toolbar:{paddingTop:"1em"}}})(kt),jt=a(9),Dt=a(96),Nt=a(73),Pt=a.n(Nt),At=a(77),It=a.n(At),Lt=a(85),_t=a.n(Lt),Mt=a(79),Rt=a.n(Mt),Bt=a(83),Ft=a.n(Bt),Ut=a(84),Wt=a.n(Ut),qt=a(27),zt=a.n(qt),Ht=a(82),Gt=a.n(Ht),Vt=a(165),Jt=a.n(Vt),Zt=a(59),Yt=a.n(Zt),Qt=a(164),$t=a.n(Qt),Kt=a(185),Xt=a.n(Kt),ea=a(147),ta=a.n(ea),aa=a(81),na=a(80),ra=a.n(na),ia=a(152),oa=a.n(ia),sa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).handleVideo=function(e){},a.videoError=function(e){console.log(e)},a._onDetected=function(e){oa.a.canvas.dom.overlay.style.display="none",a.props.onDetected(e)},a.state={source:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"interactive",className:"viewport",style:{textAlign:"center"}},r.a.createElement("video",{className:"videoCamera",autoPlay:!0,preload:"auto",src:"",muted:"true",playsInLine:!0}),r.a.createElement("canvas",{className:"drawingBuffer",style:{display:"none"}}))}},{key:"componentDidMount",value:function(){oa.a.init({inputStream:{type:"LiveStream",constraints:{width:500,height:480,facingMode:"environment"}},locator:{patchSize:"large",halfSample:!0},numOfWorkers:4,decoder:{readers:["code_128_reader","code_39_reader"]},locate:!0},function(e){if(e)return console.log(e);oa.a.start()}),oa.a.onDetected(this._onDetected)}},{key:"componentWillUnmount",value:function(){oa.a.offDetected(this._onDetected),oa.a.stop()}}]),t}(r.a.Component),ca=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},drawingBuffer:{display:"none"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")}}})(sa),la=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.result;return e?r.a.createElement(C.a,{variant:"subtitle1"},e.codeResult.code):null}}]),t}(r.a.Component),ua=a(78),pa=a.n(ua),da=a(106),ma=a.n(da),ha=a(149),fa=a.n(ha),ga=a(299),va=a.n(ga),ba=a(151),Ea=a.n(ba),ya=a(150),Sa=a.n(ya),wa=a(90),Ca=a.n(wa),xa="http://137.132.165.139:3000/graphql";var Oa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).noConnection=function(){a.props.fetchingDone();var e=r.a.createElement("div",{style:{marginTop:"1em",textAlign:"center"}}," Unable to connect to beacon. ",r.a.createElement("br",null),"Please check Gimbal if it is successfully activated ");a.setState({errorMessage:e}),a.deleteDevice()},a.verifyConnection=function(){var e=!1,t="b".concat(a.props.beaconCounter);if(a.props.deviceLogs.map(function(n){n.id==t&&(e=!0,a.props.assignBeacon([t]))}),1==e)a.setState({fetchAttempts:0}),a.props.fetchingDone(),clearInterval(a.timer),a.timer=null,a.props.updateBeaconCount(a.props.beaconCounter),a.handleClose();else{var n=a.state.fetchAttempts-1;a.setState({fetchAttempts:n})}},a.handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.props.handleClose()},a.createOptions=function(e){var t=e.map(function(e){return{value:e.id,label:e.id}});a.setState({options:t})},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.props.fetchMaps(e.data.data.maps),a.createOptions(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(xa),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.packageDevice=function(){var e={};return""!=a.state.id&&(e.device={id:a.state.id,type:"mobile"}),""!=a.state.beaconId&&(e.beacon={id:a.state.beaconId},""!=a.state.measuredPower&&(e.beacon.measuredPower=a.state.measuredPower)),""!=a.state.gattId&&(e.gatt={id:a.state.gattId},""!=a.state.gattProfile&&(e.gatt.profile=JSON.parse(a.state.gattProfile))),e},a.deleteDevice=function(){var e={id:a.state.id};a.requestPost({query:"\n      mutation ($id: String!) {\n        deleteDevice(id: $id) { id }\n      }\n    ",variables:e})},a.createDevice=function(e){var t={input:e};a.requestPost({query:"\n        mutation ($input: CreateDeviceInput!) {\n          createDevice(input: $input) { id }\n        }\n      ",variables:t})},a.requestPost=function(e){var t=e.query,a=e.variables;Re()({method:"post",url:"".concat("http://137.132.165.139:3000/graphql"),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.handleSubmit=function(e){e.preventDefault(),a.props.fetchingProcess();a.state.type;a.setState({fetchAttempts:30});var t=a.packageDevice();a.createDevice(t),a.timer=setInterval(function(){return a.verifyConnection()},1e3)},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){"ward"==e?a.setState(Object(J.a)({},e,t)):a.setState(Object(J.a)({},e,t.target.value))}},a.checkGimbal=function(){window.open("https://manager.gimbal.com/login/users/sign_in")},a.cancel=function(){a.props.history.push("/home")},a._scan=function(e){e.preventDefault(),a.setState({scanning:!a.state.scanning})},a._onDetected=function(e){a.state.results.indexOf(e)<0&&a.setState({results:a.state.results.concat([e])})},a.renderLoading=function(){return r.a.createElement("div",{style:{textAlign:"center",marginTop:"1em"}}," ",r.a.createElement(ra.a,null),"  ",r.a.createElement(C.a,{variant:"subtitle2"}," Verifying ... "))},a.state={anchorEl:null,auth:!0,id:"",beaconId:"",measuredPower:"-63",gattId:"",gattProfile:"",open:!1,beacon:a.props.beacon,scanning:!1,results:[],options:[],edit:!1,step:1,fetchAttempts:-1,errorMessage:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchNewBeacon(),""!=this.props.open&&null!=this.props.open&&this.setState({open:this.props.open})}},{key:"componentDidUpdate",value:function(e,t){if(""!==this.props.open&&null!=this.props.open&&this.props.open!==this.state.open&&this.setState({open:this.props.open}),""!==this.props.beaconCounter&&null!=this.props.beaconCounter&&this.props.beaconCounter!==e.beaconCounter){var a="3:".concat(this.props.beaconCounter),n="b".concat(this.props.beaconCounter);this.setState({beaconId:a}),this.setState({id:n})}1==this.props.fetching&&0==this.state.fetchAttempts&&(this.noConnection(),clearInterval(this.timer),this.timer=null)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=(e.theme,this.state),n=a.anchorEl;a.auth,Boolean(n);return r.a.createElement("div",null,r.a.createElement(fa.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(Sa.a,{id:"form-dialog-title"},"Add Beacon"),r.a.createElement(Ea.a,null,r.a.createElement(S.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(I.a,{className:t.card,style:{display:"inline-block"}},r.a.createElement(R.a,{style:{textAlign:"center"}},r.a.createElement(ut.a,{className:t.idPaper,elevation:10},r.a.createElement("span",null,r.a.createElement(pe.a,{style:{fontSize:"30px",color:"white"}}))),r.a.createElement(C.a,{color:"textSecondary"},"Beacon ID"),r.a.createElement(C.a,{variant:"h5",component:"h2",style:{fontSize:"1.825em"}},"3:",""!=this.props.beaconCounter?this.props.beaconCounter:null),this.props.fetching?this.renderLoading():null),this.props.fetching?null:r.a.createElement(Ca.a,{className:t.card_actions},r.a.createElement(S.a,{justify:"center",container:!0,spacing:24},r.a.createElement(g.a,{size:"small",onClick:this.checkGimbal},"Gimbal Site")))))),r.a.createElement(C.a,{variant:"subtitle1",style:{color:"red"}}," ",this.state.errorMessage,"  "),r.a.createElement(C.a,{variant:"body1",component:"p",paragraph:!0,style:{marginTop:"16px"}},"1. Copy the Beacon ID provided and open the Gimbal Site by clicking on the 'Gimbal Site' button."),r.a.createElement(C.a,{variant:"body1",component:"p",paragraph:!0},"2. Login to the Gimbal Site and navigate to ",r.a.createElement("b",null," Beacons > Beacons Management ")),r.a.createElement(C.a,{variant:"body1",component:"p",paragraph:!0},"3. Click on ",r.a.createElement("b",null,"+ Activate Beacon")," on the top of the table of beacons"),r.a.createElement(C.a,{variant:"body1",component:"p",paragraph:!0},"4. Fill in the Beacon ID under the Beacon Name and the Factory ID can be found in the Beacon itself. Submit the form and wait and once successfully activated, return to this application."),r.a.createElement("br",null)),r.a.createElement(va.a,null,r.a.createElement(g.a,{onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(g.a,{onClick:this.handleSubmit,color:"primary"},"Next"))))}}]),t}(n.Component),ka=Object(s.b)(function(e){return{beacon:e.beacon,maps:e.maps,edit:e.edit,fetching:e.fetching,beaconCounter:e.beaconCounter.count,deviceLogs:e.deviceLogs}},function(e){return{confirmType:function(t){return e(We(t))},addPatient:function(t){return e(Je(t))},editPatient:function(t){return e(qe(t))},removePatient:function(t){return e(Ze(t))},fetchMaps:function(t){return e(ze(t))},fetchNewBeacon:function(t){return e((a=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Pe.on("value",function(e){t({type:"FETCH_NEW_BEACON",payload:e.val()})},function(e){console.log("The read failed: "+e.code)});case 2:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}));var a},fetchingProcess:function(t){return e({type:"FETCHING_PROCESS"})},assignBeacon:function(t){return e(Fe(t))},fetchingDone:function(t){return e({type:"FETCHING_DONE"})},updateBeaconCount:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){var n;return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e+1,Pe.set({count:n});case 2:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))}}})(Oa),Ta=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},idPaper:{float:"left",padding:"15px",marginTop:"-20px",marginRight:"15px",borderRadius:"3px",zIndex:2,backgroundColor:"#339af0",boxShadow:"0 4px 20px 0 rgba(0, 0, 0,.14), 0 7px 10px -5px rgba(51, 154, 240,.4)"},grow:{flexGrow:1},card:{minWidth:200},title:{fontSize:14},pos:{marginBottom:12},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",padding:"18.5px 14px"},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16,padding:"18.5px 14px"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},card_actions:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:"16px"}}},{withTheme:!0})(ka),ja="http://137.132.165.139:3000/api";function Da(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var Na=[{id:"serialno",numeric:!1,disablePadding:!0,label:"Serial No"}],Pa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.onSelectAllClick,t.order),n=t.orderBy;t.numSelected,t.rowCount;return r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,r.a.createElement(zt.a,{padding:"checkbox"}),Na.map(function(t){return r.a.createElement(zt.a,{key:t.id,numeric:t.numeric,padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},r.a.createElement(ta.a,{title:"Sort",placement:t.numeric?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement($t.a,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(r.a.Component),Aa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleOpen=function(){a.props.handleOpen()},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.numSelected,a=e.classes;return r.a.createElement(O.a,{className:xt()(a.root,Object(J.a)({},a.highlight,t>0))},r.a.createElement("div",{className:a.title},t>0?r.a.createElement(C.a,{color:"inherit",variant:"subtitle1"},t," selected"):[r.a.createElement(C.a,{variant:"h6",id:"tableTitle"},"Available Beacons"),r.a.createElement(C.a,{variant:"caption",id:"tableSubtitle"},"Optional")]),r.a.createElement("div",{className:a.spacer}),r.a.createElement("div",{className:a.actions},t>0?null:r.a.createElement(ta.a,{title:"Add Beacon"},r.a.createElement(T.a,{"aria-label":"Add",onClick:this.handleOpen},r.a.createElement(P.a,null)))))}}]),t}(r.a.Component);Aa=Object(q.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(aa.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{paddingTop:".5em",flex:"0 0 auto"}}})(Aa);var Ia=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"serialno",selected:[],data:[],page:0,rowsPerPage:5,open:!1},a.getDeviceLogs=function(e){return Re()({method:"get",url:"".concat(ja,"/Devices/logs"),headers:{"Content-Type":"application/json"}}).then(function(e){a.props.fetchDeviceLocations(e.data)})},a.filterLogs=function(){var e=a.props.deviceLogs,t=[];e.map(function(e){var n=!1;a.props.patients.forEach(function(t){e.id==t.beacon&&(n=!0)}),a.props.assets.forEach(function(t){e.id==t.beacon&&(n=!0)}),a.props.staff.forEach(function(t){e.id==t.beacon&&(n=!0)}),0==n&&"b"==e.id.charAt(0)&&t.push(e),1==n&&a.props.edit.beacon==e.id&&t.push(e)}),t=a.createData(t),a.setState({data:t})},a.createData=function(e){var t=[],a=0;return e.forEach(function(e){var n={id:a,serialno:e.id};t.push(n),a+=1}),t},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleSelectAllClick=function(e){e.target.checked?a.setState(function(e){return{selected:e.data.map(function(e){return e.id})}}):a.setState({selected:[]})},a.handleClick=function(e,t,n){var r=a.state.selected,i=r.indexOf(t);-1===i&&(i=r.indexOf(n));var o=[];if(-1===i?o[0]=t:0===i?o=o.concat(r.slice(1)):i===r.length-1?o=o.concat(r.slice(0,-1)):i>0&&(o=o.concat(r.slice(0,i),r.slice(i+1))),a.setState({selected:o}),1===o.length){var s=[a.state.data[o[0]].serialno];a.props.assignBeacon(s)}else{a.props.assignBeacon([])}},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.timer=setInterval(function(){return e.getDeviceLogs()},1e3),""!=this.props.edit){var t=this.props.edit.beacon;null!=t&&"None"!=t&&(this.props.assignBeacon(t),this.setState({selected:[t]})),this.setState({edit:!0})}}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.timer=null}},{key:"componentDidUpdate",value:function(e){this.props.beacon!=e.beacon&&(this.setState({selected:this.props.beacon}),this.forceUpdate()),this.props.deviceLogs!==e.deviceLogs&&this.filterLogs(),1==this.state.edit&&""==this.props.edit&&(this.setState({selected:[]}),this.props.assignBeacon("None"),this.setState({edit:!1}))}},{key:"render",value:function(){var e,t,a,n=this,i=this.props.classes,o=this.state,s=o.data,c=o.order,l=o.orderBy,u=o.selected,p=o.rowsPerPage,d=o.page,m=p-Math.min(p,s.length-d*p);return r.a.createElement(ut.a,{className:i.root},r.a.createElement(Ta,{open:this.state.open,handleClose:this.handleClose}),r.a.createElement(Aa,{numSelected:u.length,handleOpen:this.handleOpen}),r.a.createElement("div",{className:i.tableWrapper},r.a.createElement(Ft.a,{className:i.table,"aria-labelledby":"tableTitle"},r.a.createElement(Pa,{numSelected:u.length,order:c,orderBy:l,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:s.length}),r.a.createElement(Wt.a,null,(e=s,t=function(e,t){return"desc"===e?function(e,a){return Da(e,a,t)}:function(e,a){return-Da(e,a,t)}}(c,l),a=e.map(function(e,t){return[e,t]}),a.sort(function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(function(e){return e[0]})).slice(d*p,d*p+p).map(function(e){var t=n.isSelected(e.id);return 0==t&&(t=n.isSelected(e.serialno)),r.a.createElement(Yt.a,{hover:!0,onClick:function(t){return n.handleClick(t,e.id,e.serialno)},role:"checkbox","aria-checked":t,tabIndex:-1,key:e.id,selected:t},r.a.createElement(zt.a,{style:{width:"1.5rem"},padding:"checkbox"},r.a.createElement(Xt.a,{checked:t})),r.a.createElement(zt.a,{component:"th",scope:"row",padding:"none"},e.serialno))}),m>0&&r.a.createElement(Yt.a,{style:{height:49*m}},r.a.createElement(zt.a,{colSpan:6}))))),r.a.createElement(Jt.a,{component:"div",count:s.length,rowsPerPage:p,page:d,rowsPerPageOptions:[5,10,15],backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(r.a.Component),La=Object(s.b)(function(e){return{patients:e.patients,assets:e.assets,staff:e.staff,deviceLogs:e.deviceLogs,edit:e.edit,beacon:e.beacon}},function(e){return{assignBeacon:function(t){return e(Fe(t))},fetchDeviceLocations:function(t){return e(Ve(t))}}})(Ia),_a=Object(q.withStyles)(function(e){return{root:{width:"100%",marginTop:3*e.spacing.unit},table:{minWidth:500},tableWrapper:{overflowX:"auto"}}})(La),Ma="http://137.132.165.139:3000/api",Ra="http://137.132.165.139:3000/graphql";function Ba(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var Fa=[{id:"serialno",numeric:!1,disablePadding:!0,label:"Serial No"}],Ua=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.onSelectAllClick,t.order),n=t.orderBy;t.numSelected,t.rowCount;return r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,r.a.createElement(zt.a,{padding:"checkbox"}),Fa.map(function(t){return r.a.createElement(zt.a,{key:t.id,numeric:t.numeric,padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},r.a.createElement(ta.a,{title:"Sort",placement:t.numeric?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement($t.a,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(r.a.Component),Wa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleOpen=function(){a.props.handleOpen()},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.numSelected,a=e.classes;return r.a.createElement(O.a,{className:xt()(a.root,Object(J.a)({},a.highlight,t>0))},r.a.createElement("div",{className:a.title},t>0?r.a.createElement(C.a,{color:"inherit",variant:"subtitle1"},t," selected"):[r.a.createElement(C.a,{variant:"h6",id:"tableTitle"},"Available Devices"),r.a.createElement(C.a,{variant:"caption",id:"tableSubtitle"},"Optional")]),r.a.createElement("div",{className:a.spacer}))}}]),t}(r.a.Component);Wa=Object(q.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(aa.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{paddingTop:".5em",flex:"0 0 auto"}}})(Wa);var qa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"serialno",selected:[],data:[],page:0,rowsPerPage:5,open:!1},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(Ra),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.getDevices=function(e){a.request({query:"\n      query {\n        devices {\n          id\n          type\n          location\n          anchor {\n            id\n            device {\n              id\n            }\n            sensitivity\n          }\n          beacon {\n            id\n            device {\n              id\n            }\n            measuredPower\n          }\n          gatt {\n            id\n            device {\n              id\n            }\n            profile\n            connect\n          }\n        }\n      }\n    "}).then(function(e){return a.props.fetchDevices(e.data.data.devices)})},a.getDeviceLogs=function(e){return Re()({method:"get",url:"".concat(Ma,"/Devices/logs"),headers:{"Content-Type":"application/json"}}).then(function(e){a.props.fetchDeviceLocations(e.data)})},a.filterLogs=function(){var e=a.props.devices,t=[];e.map(function(e){var n=!1;a.props.patients.forEach(function(t){"None"!=t.devices[0]&&t.devices.map(function(t){t.id==e.id&&(n=!0)})}),0==n&&null!=e.gatt&&t.push(e),1==n&&null!=a.props.edit.devices&&a.props.edit.devices.map(function(a){a.id==e.id&&t.push(e)})}),t=a.createData(t),a.setState({data:t})},a.createData=function(e){var t=[],a=0;return e.forEach(function(e){var n={id:a,serialno:e.id,uuid:e.beacon.id};t.push(n),a+=1}),t},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleSelectAllClick=function(e){e.target.checked?a.setState(function(e){return{selected:e.data.map(function(e){return e.id})}}):a.setState({selected:[]})},a.handleClick=function(e,t,n){var r=a.state.selected,i=r.indexOf(t);if(-1===i){var o=0;r.map(function(e){"object"===typeof e&&n==e.id&&(i=o),o+=1})}var s=[];if(-1===i?s=s.concat(r,t):0===i?s=s.concat(r.slice(1)):i===r.length-1?s=s.concat(r.slice(0,-1)):i>0&&(s=s.concat(r.slice(0,i),r.slice(i+1))),a.setState({selected:s}),s.length>0){var c=a.state.data,l=[];s.map(function(e){if("object"===typeof e|"None"==e)l.push(e);else{var t={id:c[e].serialno,uuid:c[e].uuid};l.push(t)}}),a.props.assignDevices(l)}else{a.props.assignDevices(["None"])}},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.getDevices(),""!=this.props.edit){var e=this.props.edit.devices;null!=e&&"None"!=e[0]&&(this.props.assignDevices(e),this.setState({selected:e})),this.setState({edit:!0})}}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.timer=null}},{key:"componentDidUpdate",value:function(e){this.props.devices!==e.devices&&this.filterLogs(),1==this.state.edit&&""==this.props.edit&&(this.setState({selected:[]}),this.props.assignDevices(["None"]),this.setState({edit:!1}))}},{key:"render",value:function(){var e,t,a,n=this,i=this.props.classes,o=this.state,s=o.data,c=o.order,l=o.orderBy,u=o.selected,p=o.rowsPerPage,d=o.page,m=p-Math.min(p,s.length-d*p);return r.a.createElement(ut.a,{className:i.root},r.a.createElement(Ta,{open:this.state.open,handleClose:this.handleClose}),r.a.createElement(Wa,{numSelected:u.length,handleOpen:this.handleOpen}),r.a.createElement("div",{className:i.tableWrapper},r.a.createElement(Ft.a,{className:i.table,"aria-labelledby":"tableTitle"},r.a.createElement(Ua,{numSelected:u.length,order:c,orderBy:l,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:s.length}),r.a.createElement(Wt.a,null,(e=s,t=function(e,t){return"desc"===e?function(e,a){return Ba(e,a,t)}:function(e,a){return-Ba(e,a,t)}}(c,l),a=e.map(function(e,t){return[e,t]}),a.sort(function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(function(e){return e[0]})).slice(d*p,d*p+p).map(function(e){var t=n.isSelected(e.id);return 0==t&&n.state.selected.map(function(a){"object"===typeof a&&e.serialno==a.id&&(t=!0)}),r.a.createElement(Yt.a,{hover:!0,onClick:function(t){return n.handleClick(t,e.id,e.serialno)},role:"checkbox","aria-checked":t,tabIndex:-1,key:e.id,selected:t},r.a.createElement(zt.a,{style:{width:"1.5rem"},padding:"checkbox"},r.a.createElement(Xt.a,{checked:t})),r.a.createElement(zt.a,{component:"th",scope:"row",padding:"none"},e.serialno))}),m>0&&r.a.createElement(Yt.a,{style:{height:49*m}},r.a.createElement(zt.a,{colSpan:6}))))),r.a.createElement(Jt.a,{component:"div",count:s.length,rowsPerPage:p,page:d,rowsPerPageOptions:[5,10,15],backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(r.a.Component),za=Object(s.b)(function(e){return{patients:e.patients,deviceLogs:e.deviceLogs,edit:e.edit,devices:e.devices}},function(e){return{assignBeacon:function(t){return e(Fe(t))},assignDevices:function(t){return e(Ue(t))},fetchDevices:function(t){return e(Ge(t))},fetchDeviceLocations:function(t){return e(Ve(t))}}})(qa),Ha=Object(q.withStyles)(function(e){return{root:{width:"100%",marginTop:3*e.spacing.unit},table:{minWidth:500},tableWrapper:{overflowX:"auto"}}})(za),Ga=a(129),Va=a(120),Ja=a.n(Va),Za="http://137.132.165.139:3000/graphql";function Ya(e){var t=e.inputRef,a=Object(Dt.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var Qa={Control:function(e,t){return r.a.createElement(ct.a,Object.assign({fullWidth:!0,variant:"outlined",style:{borderColor:"red !important"},InputProps:{inputComponent:Ya,inputProps:Object(jt.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)},required:!0,error:e.selectProps.error,helperText:e.selectProps.error?"This field is required":null},e.selectProps.textFieldProps))},SubMenu:function(e){return r.a.createElement(ut.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(pa.a,{tabIndex:-1,label:e.children,className:xt()(e.selectProps.classes.chip,Object(J.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(ma.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(H.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(C.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},$a=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).flushData=function(){a.setState({name:"",age:"",race:"",gender:"",ward:"",edit:!1});a.props.assignBeacon("")},a.createOptions=function(e){var t=e.map(function(e){return{value:e.id,label:e.id}});a.setState({options:t})},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.props.fetchMaps(e.data.data.maps),a.createOptions(e.data.data.maps)})},a.crossReferenceData=function(e){_e.on("value",function(t){for(var n=t.val(),r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];if(o==e.codeResult.code){var s=n[o].name,c=n[o].race,l=n[o].age,u=n[o].gender;a.setState({name:s,gender:u,race:c,age:l}),a.forceUpdate()}}})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(Za),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({drawer:!1}),a.setState({anchorEl:null})},a.handleSubmit=function(e){e.preventDefault(),a.handleClose();var t=!1,n=a.state.type;""==a.state.name&&(a.setState({nameError:!0}),t=!0),null==a.state.ward.value&&(a.setState({wardError:!0}),t=!0);var r=a.props.devices;if(null!=r&&"None"!=r[0]&&r.length>0){var i=0,o=0,s=0;r.map(function(e){"e"==e.id.charAt(0)&&(o+=1),"h"==e.id.charAt(0)&&(s+=1),"i"==e.id.charAt(0)&&(i+=1)}),i>1|o>1|s>1&&(t=!0)}if(!t){null==r&&(r=["None"]);var c={name:a.state.name,age:a.state.age,race:a.state.race,gender:a.state.gender,ward:a.state.ward.value,beacon:a.props.beacon,devices:r,highlight:!1},l={name:a.state.name,age:a.state.age,race:a.state.race,gender:a.state.gender,ward:a.state.ward.value,beacon:a.props.beacon,devices:r,type:n};a.state.edit?(c.id=a.props.edit.id,a.props.updatePatient(c),a.setState({editSuccess:!0})):(a.props.updatePatientCount(a.props.patientCounter.count),a.props.addPatient(c)),a.props.confirmType({confirm:l});a.props.assignBeacon("None"),a.props.assignDevices(["None"]),a.props.history.push("/addConfirmation")}},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.removePatient=function(){a.props.removePatient(a.props.edit),a.props.history.push("/locationTracking")},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.handleChange=function(e){return function(t){"ward"==e?a.setState(Object(J.a)({},e,t)):a.setState(Object(J.a)({},e,t.target.value))}},a.cancel=function(){a.props.editPatient(""),a.state.edit?a.props.history.push("/locationTracking"):a.props.history.push("/home")},a._scan=function(){a.setState({scanning:!a.state.scanning})},a._onDetected=function(e){a.state.results.indexOf(e)<0&&(a.setState({results:[e]}),a.crossReferenceData(e),a._scan())},a.state={anchorEl:null,auth:!0,name:"",age:"",race:"",gender:"",ward:"",type:"Patient",beacon:a.props.beacon,scanning:!1,results:[],options:[],edit:!1,editSuccess:!1,nameError:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){0==this.state.editSuccess&&this.props.editPatient("")}},{key:"componentDidMount",value:function(){if(this.fetch(),this.props.fetchPatientCount(),""!=this.props.edit&&null!=this.props.edit){var e=this.props.edit;this.setState({name:e.name,age:e.age,race:e.race,gender:e.gender,ward:{value:e.ward,label:e.ward},edit:!0})}else this.flushData()}},{key:"componentDidUpdate",value:function(e,t){1==this.state.edit&&""==this.props.edit&&this.flushData(),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,i=this.state,o=i.anchorEl,s=i.auth,c=Boolean(o),l={input:function(e){return Object(jt.a)({},e,{color:n.palette.text.primary,cursor:"pointer","& input":{font:"inherit"}})}};return this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:a.grow,style:{color:"black"}},this.state.edit?"Edit":"Add"," Patient"),s&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":c?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:c,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement("form",{className:a.align,onSubmit:this.handleSubmit},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:a.layout},r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Patient")),r.a.createElement(S.a,{item:!0,xs:6,style:{margin:"auto"}},this.state.edit?r.a.createElement(g.a,{variant:"outlined",onClick:this.removePatient,style:{float:"right"}}," Delete "):null)),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},"Barcode Scan"),r.a.createElement(g.a,{variant:"outlined",onClick:this._scan},this.state.scanning?"Stop":"Start"),this.state.results.map(function(e){return r.a.createElement(la,{key:e.codeResult.code,result:e})}),this.state.scanning?r.a.createElement(ca,{onDetected:this._onDetected}):null,r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Name",placeholder:"Name",autoComplete:"name",variant:"outlined",autoFocus:null!=this.state.results[0],value:this.state.name,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({name:t.target.value})},required:!0,error:this.state.nameError,helperText:this.state.nameError?"This field is required":null}))),r.a.createElement(S.a,{container:!0,direction:"row",spacing:24,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(dt.a,{margin:"normal",required:!0},r.a.createElement(ct.a,{id:"outlined-adornment-age",className:xt()(a.margin,a.textField),variant:"outlined",label:"Age",value:this.state.age,onChange:this.handleChange("age"),InputProps:{endAdornment:r.a.createElement(wt.a,{position:"end"},"Years Old")}}))),r.a.createElement(S.a,{item:!0,xs:6,style:{textAlign:"center"}},r.a.createElement(dt.a,{component:"fieldset",margin:"normal",className:a.formControl},r.a.createElement(Rt.a,{component:"legend"},"Gender"),r.a.createElement(_t.a,{"aria-label":"Gender",name:"gender1",row:!0,className:xt()(a.margin,a.textField,a.group),value:this.state.gender,onChange:this.handleChange("gender")},r.a.createElement(Pt.a,{value:"male",control:r.a.createElement(It.a,null),label:"Male"}),r.a.createElement(Pt.a,{value:"female",control:r.a.createElement(It.a,null),label:"Female"}))))),r.a.createElement(S.a,{container:!0,direction:"row",spacing:0,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(dt.a,{required:!0,fullWidth:!0},r.a.createElement(ct.a,{id:"outlined-select-race",select:!0,label:"Race",className:a.textField,value:this.state.race,onChange:this.handleChange("race"),SelectProps:{MenuProps:{className:a.menu}},margin:"normal",variant:"outlined"},["Chinese","Malay","Indian","Others"].map(function(e){return r.a.createElement(H.a,{key:e,value:e},e)}))),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ja.a,null,r.a.createElement(Ga.a,{classes:a,styles:l,options:this.state.options,components:Qa,value:this.state.ward,onChange:this.handleChange("ward"),placeholder:"Ward*",isClearable:!0,error:this.state.wardError}))),r.a.createElement(_a,null),r.a.createElement(Ha,null))),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},r.a.createElement(g.a,{type:"submit",variant:"contained",color:"primary"},"Submit"),r.a.createElement(g.a,{style:{marginLeft:"3em"},onClick:this.cancel},"Cancel"))))))}}]),t}(n.Component),Ka=Object(s.b)(function(e){return{beacon:e.beacon,maps:e.maps,edit:e.edit,devices:e.assignDevices,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated,patientCounter:e.patientCounter}},function(e){return{confirmType:function(t){return e(We(t))},addPatient:function(t){return e(Je(t))},assignDevices:function(t){return e(Ue(t))},editPatient:function(t){return e(qe(t))},removePatient:function(t){return e(Ze(t))},fetchMaps:function(t){return e(ze(t))},assignBeacon:function(t){return e(Fe(t))},signOutUser:function(t){return e(Ye())},fetchPatientCount:function(t){return e((a=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Ae.on("value",function(e){t({type:"FETCH_PATIENT_COUNT",payload:e.val()})},function(e){console.log("The read failed: "+e.code)});case 2:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}));var a},updatePatientCount:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){var n;return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e+1,Ae.set({count:n});case 2:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},updatePatient:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("patients/".concat(e.id)).set(e);case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))}}})($a),Xa=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",padding:"18.5px 14px"},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16,padding:"18.5px 14px"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},error:{borderColor:"red !important"}}},{withTheme:!0})(Ka),en=a(100),tn=a.n(en),an=a(89),nn=a.n(an),rn="http://137.132.165.139:3000/graphql";function on(e){var t=e.inputRef,a=Object(Dt.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var sn={Control:function(e){return r.a.createElement(ct.a,Object.assign({fullWidth:!0,variant:"outlined",required:!0,error:e.selectProps.error,helperText:e.selectProps.error?"This field is required":null,InputProps:{inputComponent:on,inputProps:Object(jt.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},SubMenu:function(e){return r.a.createElement(ut.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(pa.a,{tabIndex:-1,label:e.children,className:xt()(e.selectProps.classes.chip,Object(J.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(ma.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(H.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(C.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},cn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).flushData=function(){a.setState({name:"",owner:"",image:"",imageName:"",ward:"",edit:!1});a.props.assignBeacon("")},a.createOptions=function(e){var t=e.map(function(e){return{value:e.id,label:e.id}});a.setState({options:t})},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.props.fetchMaps(e.data.data.maps),a.createOptions(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(rn),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({drawer:!1}),a.setState({anchorEl:null})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.type;a.handleClose();var n=!1;if(""==a.state.name&&(a.setState({nameError:!0}),n=!0),null==a.state.ward.value&&(a.setState({wardError:!0}),n=!0),!n){var r={name:a.state.name,image:a.state.image,imageName:a.state.imageName,owner:a.state.owner,ward:a.state.ward.value,beacon:a.props.beacon,highlight:!1},i={name:a.state.name,image:a.state.image,imageName:a.state.imageName,owner:a.state.owner,ward:a.state.ward.value,beacon:a.props.beacon,type:t};a.state.edit?(r.id=a.props.edit.id,a.props.updateAsset(r),a.setState({editSuccess:!0})):(a.props.updateAssetCount(a.props.assetCounter.count),a.props.addAsset(r)),a.props.confirmType({confirm:i});a.props.assignBeacon("None"),a.props.history.push("/addConfirmation")}},a.removeAsset=function(){a.props.removeAsset(a.props.edit),a.props.history.push("/locationTracking")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){"ward"==e?a.setState(Object(J.a)({},e,t)):a.setState(Object(J.a)({},e,t.target.value))}},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.cancel=function(){a.state.edit?a.props.history.push("/locationTracking"):a.props.history.push("/home")},a.state={anchorEl:null,auth:!0,name:"",owner:"",image:"",imagePreview:"",imageName:"",ward:"",type:"Asset",beacon:a.props.beacon,nameError:!1,wardError:!1,editSuccess:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){0==this.state.editSuccess&&this.props.editPatient("")}},{key:"componentDidMount",value:function(){if(this.fetch(),this.props.fetchAssetCount(),""!=this.props.edit&&null!=this.props.edit){var e=this.props.edit;this.setState({name:e.name,owner:e.owner,image:e.image,imageName:e.imageName,ward:{value:e.ward,label:e.ward},edit:!0})}else this.flushData()}},{key:"componentDidUpdate",value:function(e,t){1==this.state.edit&&""==this.props.edit&&this.flushData(),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,i=this.state,o=i.anchorEl,s=i.auth,c=Boolean(o),l=this.state.imagePreview,u=this.state.imageName,p={input:function(e){return Object(jt.a)({},e,{color:n.palette.text.primary,"& input":{font:"inherit"}})}};return this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:a.grow,style:{color:"black"}},this.state.edit?"Edit":"Add"," Asset"),s&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":c?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:c,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement("form",{className:a.align},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:a.layout},r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Asset")),r.a.createElement(S.a,{item:!0,xs:6,style:{margin:"auto"}},this.state.edit?r.a.createElement(g.a,{variant:"outlined",onClick:this.removeAsset,style:{float:"right"}}," Delete "):null)),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Name",placeholder:"Name",autoComplete:"name",variant:"outlined",fullWidth:!0,value:this.state.name,className:a.textField,required:!0,error:this.state.nameError,helperText:this.state.nameError?"This field is required":null,onChange:function(t){return e.setState({name:t.target.value})}})),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},"Photo"),""==this.state.image?r.a.createElement(I.a,{style:{width:"100%"}},r.a.createElement("label",{htmlFor:"raised-button-file"},r.a.createElement(g.a,{raised:"true",component:"span",style:{height:"35vh",width:"100%"},className:a.button},r.a.createElement(C.a,{variant:"h5",gutterBottom:!0,className:a.label},"  Take A Photo "),r.a.createElement(tn.a,{className:a.cameraIcon})))):r.a.createElement(I.a,null,r.a.createElement(F.a,{style:{height:"35vh",backgroundSize:"contain"},image:l}),r.a.createElement(R.a,{className:a.cardContent},r.a.createElement(S.a,{container:!0,direction:"row",alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:9},r.a.createElement(C.a,{variant:"subtitle2"},u)),r.a.createElement(S.a,{item:!0,xs:3},r.a.createElement("label",{htmlFor:"raised-button-file"},r.a.createElement(T.a,{color:"primary",className:a.button,component:"span"},r.a.createElement(tn.a,null))),r.a.createElement(T.a,{className:a.button,"aria-label":"Delete",onClick:this.removeImage},r.a.createElement(nn.a,null))))),r.a.createElement(Ca.a,{style:{display:"none"}})),r.a.createElement("input",{accept:"image/*",className:a.input,style:{display:"none"},id:"raised-button-file",type:"file",onChange:this.imageUpload,onClick:function(e){e.target.value=null}})),r.a.createElement(S.a,{container:!0,direction:"row",spacing:0,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Owner",placeholder:"Owner",variant:"outlined",fullWidth:!0,value:this.state.owner,className:a.textField,onChange:this.handleChange("owner")})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ja.a,null,r.a.createElement(Ga.a,{classes:a,styles:p,options:this.state.options,components:sn,value:this.state.ward,onChange:this.handleChange("ward"),error:this.state.wardError,placeholder:"Ward*",isClearable:!0}))),r.a.createElement(_a,null))),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},r.a.createElement(g.a,{variant:"contained",color:"primary",onClick:function(t){return e.handleSubmit(t)}},"Submit"),r.a.createElement(g.a,{style:{marginLeft:"3em"},onClick:this.cancel},"Cancel"))))))}}]),t}(n.Component),ln=Object(s.b)(function(e){return{beacon:e.beacon,maps:e.maps,edit:e.edit,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated,assetCounter:e.assetCounter}},function(e){return{confirmType:function(t){return e(We(t))},addAsset:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("assets").push().set(e);case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},removeAsset:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("assets/".concat(e.id)).remove();case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},fetchMaps:function(t){return e(ze(t))},assignBeacon:function(t){return e(Fe(t))},editPatient:function(t){return e(qe(t))},signOutUser:function(t){return e(Ye())},fetchAssetCount:function(t){return e((a=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Ie.on("value",function(e){t({type:"FETCH_ASSET_COUNT",payload:e.val()})},function(e){console.log("The read failed: "+e.code)});case 1:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}));var a},updateAssetCount:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){var n;return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e+1,Ie.set({count:n});case 2:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},updateAsset:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("assets/".concat(e.id)).set(e);case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))}}})(cn),un=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",padding:"18.5px 14px"},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16,padding:"18.5px 14px"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0}}},{withTheme:!0})(ln),pn="http://137.132.165.139:3000/graphql";function dn(e){var t=e.inputRef,a=Object(Dt.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var mn={Control:function(e){return r.a.createElement(ct.a,Object.assign({fullWidth:!0,variant:"outlined",required:!0,error:e.selectProps.error,helperText:e.selectProps.error?"This field is required":null,InputProps:{inputComponent:dn,inputProps:Object(jt.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},SubMenu:function(e){return r.a.createElement(ut.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(pa.a,{tabIndex:-1,label:e.children,className:xt()(e.selectProps.classes.chip,Object(J.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(ma.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(H.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(C.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(C.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},hn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).flushData=function(){a.setState({name:"",age:"",race:"",gender:"",ward:"",edit:!1});a.props.assignBeacon("")},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.createOptions=function(e){var t=e.map(function(e){return{value:e.id,label:e.id}});a.setState({options:t})},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.props.fetchMaps(e.data.data.maps),a.createOptions(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(pn),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.type;a.handleClose();var n=!1;if(""==a.state.name&&(a.setState({nameError:!0}),n=!0),null==a.state.ward.value&&(a.setState({wardError:!0}),n=!0),!n){var r={name:a.state.name,age:a.state.age,race:a.state.race,gender:a.state.gender,ward:a.state.ward.value,beacon:a.props.beacon,highlight:!1},i={name:a.state.name,age:a.state.age,race:a.state.race,gender:a.state.gender,ward:a.state.ward.value,beacon:a.props.beacon,type:t};a.state.edit?(r.id=a.props.edit.id,a.props.updateStaff(r),a.setState({editSuccess:!0})):(a.props.updateStaffCount(a.props.staffCounter.count),a.props.addStaff(r)),a.props.confirmType({confirm:i});a.props.assignBeacon("None"),a.props.history.push("/addConfirmation")}},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.removeStaff=function(){a.props.removeStaff(a.props.edit),a.props.history.push("/locationTracking")},a.handleChange=function(e){return function(t){"ward"==e?a.setState(Object(J.a)({},e,t)):a.setState(Object(J.a)({},e,t.target.value))}},a.cancel=function(){a.state.edit?a.props.history.push("/locationTracking"):a.props.history.push("/home")},a.state={anchorEl:null,auth:!0,name:"",age:"",race:"",gender:"",ward:"",type:"Staff",nameError:!1,wardError:!1,beacon:a.props.beacon,editSuccess:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){0==this.state.editSuccess&&this.props.editPatient("")}},{key:"componentDidMount",value:function(){if(this.fetch(),this.props.fetchStaffCount(),""!=this.props.edit&&null!=this.props.edit){var e=this.props.edit;this.setState({name:e.name,age:e.age,race:e.race,gender:e.gender,ward:{value:e.ward,label:e.ward},edit:!0})}else this.flushData()}},{key:"componentDidUpdate",value:function(e,t){1==this.state.edit&&""==this.props.edit&&this.flushData(),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,i=this.state,o=i.anchorEl,s=i.auth,c=Boolean(o),l={input:function(e){return Object(jt.a)({},e,{color:n.palette.text.primary,"& input":{font:"inherit"}})}};return this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:a.grow,style:{color:"black"}},this.state.edit?"Edit":"Add"," Staff"),s&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":c?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:c,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement("form",{className:a.align},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:a.layout},r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Staff")),r.a.createElement(S.a,{item:!0,xs:6,style:{margin:"auto"}},this.state.edit?r.a.createElement(g.a,{variant:"outlined",onClick:this.removeStaff,style:{float:"right"}}," Delete "):null)),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Name",placeholder:"Name",autoComplete:"name",variant:"outlined",required:!0,value:this.state.name,error:this.state.nameError,helperText:this.state.nameError?"This field is required":null,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({name:t.target.value})}}))),r.a.createElement(S.a,{container:!0,direction:"row",spacing:24,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(dt.a,{margin:"normal",required:!0},r.a.createElement(ct.a,{id:"outlined-adornment-age",className:xt()(a.margin,a.textField),variant:"outlined",label:"Age",value:this.state.age,onChange:this.handleChange("age"),InputProps:{endAdornment:r.a.createElement(wt.a,{position:"end"},"Years Old")}}))),r.a.createElement(S.a,{item:!0,xs:6,style:{textAlign:"center"}},r.a.createElement(dt.a,{component:"fieldset",margin:"normal",className:a.formControl},r.a.createElement(Rt.a,{component:"legend"},"Gender"),r.a.createElement(_t.a,{"aria-label":"Gender",name:"gender1",row:!0,className:xt()(a.margin,a.textField,a.group),value:this.state.gender,onChange:this.handleChange("gender")},r.a.createElement(Pt.a,{value:"male",control:r.a.createElement(It.a,null),label:"Male"}),r.a.createElement(Pt.a,{value:"female",control:r.a.createElement(It.a,null),label:"Female"}))))),r.a.createElement(S.a,{container:!0,direction:"row",spacing:0,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(dt.a,{required:!0,fullWidth:!0},r.a.createElement(ct.a,{id:"outlined-select-race",select:!0,label:"Race",className:a.textField,value:this.state.race,onChange:this.handleChange("race"),SelectProps:{MenuProps:{className:a.menu}},margin:"normal",variant:"outlined"},["Chinese","Malay","Indian","Others"].map(function(e){return r.a.createElement(H.a,{key:e,value:e},e)}))),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ja.a,null,r.a.createElement(Ga.a,{classes:a,styles:l,options:this.state.options,components:mn,value:this.state.ward,onChange:this.handleChange("ward"),placeholder:"Ward*",isClearable:!0,error:this.state.wardError}))),r.a.createElement(_a,null))),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},r.a.createElement(g.a,{variant:"contained",color:"primary",onClick:function(t){return e.handleSubmit(t)}},"Submit"),r.a.createElement(g.a,{style:{marginLeft:"3em"},onClick:this.cancel},"Cancel"))))))}}]),t}(n.Component),fn=Object(s.b)(function(e){return{beacon:e.beacon,maps:e.maps,edit:e.edit,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated,staffCounter:e.staffCounter}},function(e){return{confirmType:function(t){return e(We(t))},addStaff:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("staff").push().set(e);case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},fetchMaps:function(t){return e(ze(t))},assignBeacon:function(t){return e(Fe(t))},removeStaff:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("staff/".concat(e.id)).remove();case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},editPatient:function(t){return e(qe(t))},signOutUser:function(t){return e(Ye())},fetchStaffCount:function(t){return e((a=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Le.on("value",function(e){t({type:"FETCH_STAFF_COUNT",payload:e.val()})},function(e){console.log("The read failed: "+e.code)});case 1:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}));var a},updateStaffCount:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){var n;return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e+1,Le.set({count:n});case 2:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},updateStaff:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ke.database().ref().child("staff/".concat(e.id)).set(e);case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))}}})(hn),gn=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",padding:"18.5px 14px"},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16,padding:"18.5px 14px"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0}}},{withTheme:!0})(fn),vn=a(438),bn=a.n(vn),En=a(188),yn=a.n(En),Sn=a(439),wn=a.n(Sn),Cn=a(440),xn=a.n(Cn),On=a(298),kn=a.n(On),Tn=a(127),jn=a.n(Tn),Dn=a(221),Nn=a.n(Dn),Pn=a(132),An=a(21),In=a(44),Ln=a.n(In),_n=(r.a.createElement,Object(An.d)({accessToken:"".concat("pk.eyJ1IjoiZnlwZW5nIiwiYSI6ImNqcmFlazM4YjAxejkzeW1wbWg2Zmp2aWsifQ.obOnEjbqcpEWu9HIh6zPlw"),maxZoom:13,minZoom:8})),Mn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).createBeaconMarkers=function(){var e=a.props.map;if(""!=e){var t=a.props.deviceLogs.filter(function(t){return t.map.id==e.id}),n=[],r=[],i=[];t.map(function(e){a.props.patients.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,n.push(a)}}),a.props.staff.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,r.push(a)}}),a.props.assets.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,i.push(a)}})}),a.setState({mobileDevices:n}),a.setState({staffDevices:r}),a.setState({assetDevices:i})}},a.initializeMap=function(e,t){null!=e&&"simulation_ward"==e.id&&((e=JSON.parse(JSON.stringify(e))).coordinates=[[0,.114],[.6217262964,.114],[.6217262964,0],[0,0]],a.setState({map:e}),a.timer=setInterval(function(){return a.props.fetchSimulationCoordinates()},1e3),a.setState({simulation:!0}));var n={coordinates:null!=e?e.coordinates:void 0,type:"image",url:null!=e?e.imageURL:void 0};if(a.setState({sourceOptions:n}),""!=e){var i=new Ln.a.LngLatBounds(a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[3]}),a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[1]})).getCenter();if(a.setState({center:i}),0==a.state.simulation){a.createBeaconMarkers();var o=a.props.devices.filter(function(e){return"static"==e.type});o=(o=o.filter(function(e){return null!=e.location})).filter(function(t){return t.location.map.id==e.id}),a.setState({staticDevices:o})}else if(""!=a.props.simulation&&null!=a.props.simulation){var s=a.props.simulation,c=[];Object.values(s).map(function(e){"object"===typeof e&&null!==e&&null!=e.beacon&&c.push(r.a.createElement(An.a,{key:e.beacon,coordinates:[e.latitude,e.longitude],properties:{title:e.beacon,id:e.beacon}}))}),a.setState({mobileDevices:c})}}},a.onStyleLoad=function(e){var t=a.props,n=(t.onLoad,t.map);null!=n&&a.initializeMap(n)},a.getCirclePaint=function(){return{"circle-radius":a.state.circleRadius,"circle-color":"#FFFF00","circle-opacity":.4}},a._resize=function(){a.setState({viewport:Object(jt.a)({},a.state.viewport,{width:window.innerWidth,height:"70vh"})})},a._updateViewport=function(e){a.setState({viewport:e})},a.__guard__=function(e,t){return"undefined"!==typeof e&&null!==e?t(e):void 0},a.renderHighlightDevices=function(){for(var e=a.props.patients,t=a.props.staff,n=a.props.assets,i=a.state.mobileDevices,o=[],s=function(t){i.map(function(a){e[t].name==a.id&&1==e[t].highlight&&o.push(r.a.createElement(An.a,{key:a.id,coordinates:[a.lng,a.lat],properties:{title:a.id,id:a.id}}))})},c=0;c<e.length;c++)s(c);var l=function(e){a.state.staffDevices.map(function(a){t[e].name==a.id&&1==t[e].highlight&&o.push(r.a.createElement(An.a,{key:a.id,coordinates:[a.lng,a.lat],properties:{title:a.id,id:a.id}}))})};for(c=0;c<t.length;c++)l(c);var u=function(e){a.state.assetDevices.map(function(t){n[e].name==t.id&&1==n[e].highlight&&o.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))})};for(c=0;c<n.length;c++)u(c);return o},a.renderStaffDevices=function(){var e=[];return a.state.staffDevices.map(function(t){e.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))}),e},a.renderAssetDevices=function(){var e=[];return a.state.assetDevices.map(function(t){e.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))}),e},a.renderDevices=function(e){var t=[];if("static"==e)a.state.staticDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.location.lng,e.location.lat],properties:{title:e.id,id:e.id}}))});else if(a.state.simulation){if(""!=a.props.simulation&&null!=a.props.simulation){var n=a.props.simulation;Object.values(n).map(function(e){"object"===typeof e&&null!==e&&null!=e.beacon&&t.push(r.a.createElement(An.a,{key:e.beacon,coordinates:[e.latitude,e.longitude],properties:{title:e.beacon,id:e.beacon}}))})}}else a.state.mobileDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.lng,e.lat],properties:{title:e.id,id:e.id}}))});return t},a.renderPopup=function(){return a.state.popupInfo&&r.a.createElement(Pn.a,{tipSize:5,anchor:"bottom-right",longitude:a.state.popupInfo.state.longitude,latitude:a.state.popupInfo.state.latitude,onClose:function(){return a.setState({popupInfo:null})},closeOnClick:!0},r.a.createElement("h4",null,a.state.popupInfo.state.fullName),r.a.createElement("p",null,a.state.popupInfo.incidentNumber," ",a.state.popupInfo.disaster," incident(s)"),r.a.createElement("div",{class:"text-center"},r.a.createElement("img",{src:a.state.popupInfo.icon.imgUrl,style:{height:"50px"}})))},a.state={viewport:{latitude:37.785164,longitude:-100,zoom:2.8,bearing:0,pitch:0,width:500,height:500},popupInfo:null,map:"",sourceOptions:{},center:[-.2416815,51.5285582],staticDevices:"",mobileDevices:[],staffDevices:[],assetDevices:[],circleRadius:30,simulation:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this._resize),null!=this.props.map&&this.initializeMap(this.props.map)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize),clearInterval(this.timer)}},{key:"componentDidUpdate",value:function(e){this.props.map!==e.map&&(this.setState({simulation:!1}),clearInterval(this.timer),this.initializeMap(this.props.map)),this.props.deviceLogs!==e.deviceLogs&&this.createBeaconMarkers()}},{key:"render",value:function(){this.state.viewport;var e=this.state.sourceOptions,t=this.state.center;this.props.map;var a=this.props,n=(a.children,a.onLoad,a.map,a.height,a.width,window.location.origin),i={version:8,name:"custom",sources:{},sprite:"".concat(n,"/mapbox-styles/maki"),glyphs:"".concat(n,"/mapbox-styles/font/{fontstack}/{range}.pbf"),layers:[]};return r.a.createElement("div",null,r.a.createElement(_n,{style:i,center:t,movingMethod:"jumpTo",ref:this.mapLocation,containerStyle:{height:"70vh",width:"100vw"},onStyleLoad:this.onStyleLoad},r.a.createElement(An.b,{type:"symbol",id:"staticDevices",layout:{"icon-image":"triangle-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}}),r.a.createElement(An.b,{type:"circle",paint:this.getCirclePaint()},this.renderHighlightDevices()),r.a.createElement(An.b,{type:"symbol",id:"patientDevices",layout:{"icon-image":"marker-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderDevices("mobile")),r.a.createElement(An.b,{type:"symbol",id:"staffDevices",layout:{"icon-image":"hospital-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderStaffDevices()),r.a.createElement(An.b,{type:"symbol",id:"assetDevices",layout:{"icon-image":"suitcase-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderAssetDevices()),""!=this.state.map&&null!=e.url?r.a.createElement(An.c,{id:"image_source",tileJsonSource:e}):null,""!=this.state.map&&null!=e.url?r.a.createElement(An.b,{id:"image_layer",before:"staticDevices",type:"raster",sourceId:"image_source"}):null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.map!=t.map&&null!=e.map)return{map:e.map}}}]),t}(n.Component),Rn=Object(s.b)(function(e){return{maps:e.maps,map:e.map,devices:e.devices,deviceLogs:e.deviceLogs,patients:e.patients,staff:e.staff,assets:e.assets,simulation:e.simulation}},function(e){return{confirmType:function(t){return e(We(t))},fetchMaps:function(t){return e(ze(t))},fetchSimulationCoordinates:function(t){return e($e())}}})(Mn),Bn=a(430),Fn=a.n(Bn),Un=a(432),Wn=a.n(Un),qn=a(433),zn=a.n(qn),Hn=a(436),Gn=a.n(Hn),Vn=a(434),Jn=a.n(Vn),Zn=a(435),Yn=a.n(Zn),Qn=a(437),$n=a.n(Qn),Kn=a(300),Xn=a.n(Kn),er=a(431),tr=a.n(er),ar={success:Fn.a,warning:tr.a,error:Wn.a,info:zn.a};var nr=Object(q.withStyles)(function(e){return{success:{backgroundColor:Jn.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:Yn.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing.unit},message:{display:"flex",alignItems:"center"}}})(function(e){var t=e.classes,a=e.className,n=e.message,i=e.onClose,o=e.variant,s=Object(Dt.a)(e,["classes","className","message","onClose","variant"]),c=ar[o];return r.a.createElement(Xn.a,Object.assign({className:xt()(t[o],a),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},r.a.createElement(c,{className:xt()(t.icon,t.iconVariant)}),n),action:[r.a.createElement(T.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:i},r.a.createElement(Gn.a,{className:t.icon}))]},s))}),rr=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.handleClick=function(){a.setState({open:!0})},a.handleClose=function(e,t){"clickaway"!==t&&(a.setState({open:!1}),a.props.onOffWarning())},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){1==this.props.warning&&0==e.warning&&this.setState({open:!0})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement($n.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.open,onClose:this.handleClose},r.a.createElement(nr,{variant:"error",className:e.margin,onClose:this.handleClose,message:"You have one patient that requires your immediate attention!"})))}}]),t}(r.a.Component),ir=Object(q.withStyles)(function(e){return{margin:{margin:e.spacing.unit}}})(rr),or="http://137.132.165.139:3000/graphql",sr="http://137.132.165.139:3000/api",cr=0;function lr(e,t,a,n,r){return{id:cr+=1,name:e,calories:t,object:a,carbs:n,protein:r}}function ur(e){return r.a.createElement(Nn.a,Object.assign({direction:"up"},e))}lr("Frozen yoghurt",159,6,24,4),lr("Ice cream sandwich",237,9,37,4.3),lr("Eclair",262,16,24,6),lr("Cupcake",305,3.7,67,4.3),lr("Gingerbread",356,16,49,3.9);var pr=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).tweenTransientDevices=function(){var e=a.props.deviceLogs,t={},n={};e.forEach(function(e){var r=e.id,i=e.lat,o=e.lng;e.map;t[r]={lat:i,lng:o},null!=a.state.transientDevices[r]?t[r]={lat:i,lng:o}:n[r]={lat:i,lng:o}}),a.setState({transitionDevices:Object.assign({},a.state.transientDevices,n)})},a.createDataRows=function(){var e=a.props.patients,t=a.props.staff,n=a.props.assets;null!=a.props.map&&(e=e.filter(function(e){return e.ward==a.props.map.id}),"patients"==a.state.filter.type&&(e=e.filter(function(e){return e.name.includes(a.state.filter.value)})),t=t.filter(function(e){return e.ward==a.props.map.id}),"staff"==a.state.filter.type&&(t=t.filter(function(e){return e.name.includes(a.state.filter.value)})),n=n.filter(function(e){return e.ward==a.props.map.id}),"assets"==a.state.filter.type&&(n=n.filter(function(e){return e.name.includes(a.state.filter.value)}))),a.setState({patients:e}),a.setState({assets:n}),a.setState({staff:t})},a.createData=function(e,t,a,n,r){return{id:cr+=1,name:e,ward:t,fat:a,carbs:n,protein:r}},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){return a.props.fetchMaps(e.data.data.maps)})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(or),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.getDevices=function(e){a.request({query:"\n      query {\n        devices {\n          id\n          type\n          location\n          anchor {\n            id\n            device {\n              id\n            }\n            sensitivity\n          }\n          beacon {\n            id\n            device {\n              id\n            }\n            measuredPower\n          }\n          gatt {\n            id\n            device {\n              id\n            }\n            profile\n            connect\n          }\n        }\n      }\n    "}).then(function(e){return a.props.fetchDevices(e.data.data.devices)})},a.getDeviceLogs=function(e){return Re()({method:"get",url:"".concat(sr,"/Devices/logs"),headers:{"Content-Type":"application/json"}}).then(function(e){a.props.fetchDeviceLocations(e.data)})},a.load=function(e){var t='\n      query {\n        map (id: "'.concat(e,'") {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    ');a.request({query:t}).then(function(e){a.props.loadMap(e.data.data.map),a.createDataRows()})},a.search=function(e,t){var n={type:t,value:e.target.value};a.setState({filter:n})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.infoButton=function(e){var t=Object(jt.a)({},e,{type:"Patient"});a.props.loadInfo(t),a.props.history.push("/patientInfo")},a.staffInfoButton=function(e){var t=Object(jt.a)({},e,{type:"Staff"});a.props.loadInfo(t),a.props.history.push("/staffInfo")},a.assetInfoButton=function(e){var t=Object(jt.a)({},e,{type:"Asset"});a.props.loadInfo(t),a.props.history.push("/assetInfo")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleMenuChange=function(e,t){a.setState({value:t}),a.setState({anchorEl:null}),a.setState({drawer:!1})},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.cancel=function(){a.props.history.push("/home")},a.handleToggle=function(){a.setState({filter:""}),a.setState({openLocation:!0})},a.handlePatientsToggle=function(){a.setState({filter:""}),a.setState({openPatients:!0}),a.setState({value:2})},a.handleAssetsToggle=function(){a.setState({filter:""}),a.setState({openAssets:!0}),a.setState({value:4})},a.handleStaffToggle=function(){a.setState({filter:""}),a.setState({openStaff:!0}),a.setState({value:6})},a.handleMenuClose=function(e){a.setState({openLocation:!1}),a.setState({openPatients:!1}),a.setState({openAssets:!1}),a.setState({openStaff:!1}),a.setState({value:"0"})},a.highlight=function(e,t){var n=t,r=!t.highlight;if("patient"==e){var i={highlight:r,index:a.props.patients.indexOf(n)};a.props.highlightPatient(i)}else if("asset"==e){var o={highlight:r,index:a.props.assets.indexOf(n)};a.props.highlightAsset(o)}else{var s={highlight:r,index:a.props.staff.indexOf(n)};a.props.highlightStaff(s)}},a.edit=function(e,t){a.props.editPatient(t),"patient"==e?a.props.history.push("/editPatient"):"asset"==e?a.props.history.push("/addAsset"):a.props.history.push("/addStaff")},a.offWarning=function(){a.setState({warning:!1})},a.onClickLocation=function(e){a.load(e),a.handleMenuClose()},a.createLocationItems=function(){var e=a.props.maps,t=[];e.map(function(e){a.props.map.id==e.id?t.push(r.a.createElement(H.a,{key:e.id,onClick:function(){return a.onClickLocation(e.id)}},e.id," ",r.a.createElement("i",{className:"fas fa-check",style:{marginLeft:"auto"}}))):t.push(r.a.createElement(H.a,{key:e.id,onClick:function(){return a.onClickLocation(e.id)}},e.id))});return t},a.state={anchorEl:null,anchorLocationEl:null,auth:!0,name:"",owner:"",image:"",imagePreview:"",imageName:"",ward:"",value:"0",patients:[],staff:[],assets:[],filter:"",filteredStaff:"",filteredAssets:"",openLocation:!1,openPatients:!1,openAssets:!1,openStaff:!1,transientDevices:[],warning:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetch(),this.getDevices(),this.timer=setInterval(function(){return e.getDeviceLogs()},1e3),this.createDataRows()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.timer=null}},{key:"componentDidUpdate",value:function(e,t){this.props.map!==e.map|this.state.filter!=t.filter|this.props.patients!=e.patients|this.props.staff!=e.staff|this.props.assets!=e.assets&&this.createDataRows(),this.props.deviceLogs!==e.deviceLogs&&this.tweenTransientDevices(),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.state,a=(t.openLocation,t.openPatients,t.openAssets,t.openStaff,this.props.classes),n=this.state,i=n.anchorEl,o=n.auth,s=Boolean(i),c=(this.state.imagePreview,this.state.imageName,this.state.value),l="",u="",p="";return 0==this.state.patients.length&&(l=r.a.createElement(C.a,{variant:"subtitle1",style:{padding:"1em",textAlign:"center"}}," There are currently no patients")),0==this.state.staff.length&&(u=r.a.createElement(C.a,{variant:"subtitle1",style:{padding:"1em",textAlign:"center"}}," There are currently no staff")),0==this.state.assets.length&&(p=r.a.createElement(C.a,{variant:"subtitle1",style:{padding:"1em",textAlign:"center"}}," There are currently no assets")),this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:a.grow,style:{color:"black"}},"Location Tracking"),o&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":s?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:s,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(ir,{warning:this.state.warning,onOffWarning:this.offWarning}),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement("form",{className:a.align},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:a.layout,style:{width:"auto"}},r.a.createElement(Rn,{transitionDevices:this.state.transitionDevices}))))),r.a.createElement(bn.a,{value:c,onChange:this.handleMenuChange,showLabels:!0,className:a.root},r.a.createElement(yn.a,{label:"Location",icon:r.a.createElement(wn.a,null),onClick:this.handleToggle}),r.a.createElement(fa.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.openLocation,TransitionComponent:ur,onClose:this.handleMenuClose,style:{alignItems:"center",justifyContent:"center"},fullWidth:!0},r.a.createElement(Sa.a,null,"Wards"),r.a.createElement(Ea.a,null,r.a.createElement(kn.a,null,this.createLocationItems()))),r.a.createElement(yn.a,{label:"Patients",icon:r.a.createElement(xn.a,null),onClick:this.handlePatientsToggle}),r.a.createElement(fa.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.openPatients,onClose:this.handleMenuClose,TransitionComponent:ur,style:{alignItems:"center",justifyContent:"center"},maxWidth:!1},r.a.createElement("div",{className:a.infoDialog},r.a.createElement(Sa.a,null,r.a.createElement(C.a,{variant:"h4",style:{marginLeft:"8px"}},"Patients"),r.a.createElement("div",{style:{marginLeft:"8px",marginTop:"0.5em"}},r.a.createElement(jn.a,{className:a.input,fullWidth:!0,onChange:function(t){return e.search(t,"patients")},placeholder:"Search"})),r.a.createElement("hr",null),r.a.createElement(C.a,{variant:"h6",style:{marginLeft:"8px"}},"Assigned In: ",this.props.map.id),r.a.createElement("hr",null)),r.a.createElement(Ea.a,null,r.a.createElement(Ft.a,{className:a.table},r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,r.a.createElement(zt.a,null,"Name"),r.a.createElement(zt.a,{align:"center"},"Vitals"),r.a.createElement(zt.a,{align:"center"},"Currently At"),r.a.createElement(zt.a,{align:"center"},"Actions"))),r.a.createElement(Wt.a,null,this.state.patients.map(function(t){var n="",i="-";return n=t.highlight?r.a.createElement(T.a,{style:{background:"black",color:"white",opacity:"0.4"},"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("patient",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})):r.a.createElement(T.a,{"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("patient",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})),e.props.deviceLogs.map(function(e){null!=t.beacon&&e.id==t.beacon[0]&&(i=e.map.id)}),r.a.createElement(Yt.a,{key:t.id},r.a.createElement(zt.a,{component:"th",scope:"row"},t.name),r.a.createElement(zt.a,{align:"right"},r.a.createElement("i",{className:"fas fa-heartbeat"})," ",t.fat,r.a.createElement("i",{className:"fas fa-thermometer",style:{marginLeft:"1em"}})," ",t.fat),r.a.createElement(zt.a,{align:"center"},i),r.a.createElement(zt.a,{align:"right"},n,r.a.createElement(T.a,{"aria-label":"Edit",onClick:function(){return e.edit("patient",t)},className:a.margin},r.a.createElement("i",{className:"far fa-edit",style:{fontSize:"0.7em"}})),r.a.createElement(T.a,{"aria-label":"Info",className:a.margin,onClick:function(){return e.infoButton(t)}},r.a.createElement("i",{className:"fas fa-info-circle",style:{fontSize:"0.7em"}}))))}))),l))),r.a.createElement(yn.a,{label:"Assets",icon:r.a.createElement("i",{className:"fas fa-briefcase-medical",style:{fontSize:"20px"}}),onClick:this.handleAssetsToggle}),r.a.createElement(fa.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.openAssets,onClose:this.handleMenuClose,style:{alignItems:"center",justifyContent:"center",display:"flex"},maxWidth:!1,TransitionComponent:ur},r.a.createElement("div",{className:a.infoDialog},r.a.createElement(Sa.a,null,r.a.createElement(C.a,{variant:"h4",style:{marginLeft:"8px"}},"Assets"),r.a.createElement("div",{style:{marginLeft:"8px",marginTop:"0.5em"}},r.a.createElement(jn.a,{className:a.input,fullWidth:!0,onChange:function(t){return e.search(t,"assets")},placeholder:"Search"})),r.a.createElement("hr",null),r.a.createElement(C.a,{variant:"h6",style:{marginLeft:"8px"}},"Assigned In: ",this.props.map.id),r.a.createElement("hr",null)),r.a.createElement(Ea.a,null,r.a.createElement(Ft.a,{className:a.table},r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,r.a.createElement(zt.a,null,"Name"),r.a.createElement(zt.a,{align:"center"},"Currently At"),r.a.createElement(zt.a,{align:"center"},"Actions"))),r.a.createElement(Wt.a,null,this.state.assets.map(function(t){var n="",i="-";return n=t.highlight?r.a.createElement(T.a,{style:{background:"black",color:"white",opacity:"0.4"},"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("asset",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})):r.a.createElement(T.a,{"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("asset",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})),e.props.deviceLogs.map(function(e){null!=t.beacon&&e.id==t.beacon[0]&&(i=e.map.id)}),r.a.createElement(Yt.a,{key:t.id},r.a.createElement(zt.a,{component:"th",scope:"row"},t.name),r.a.createElement(zt.a,{align:"center"},i),r.a.createElement(zt.a,{align:"right"},n,r.a.createElement(T.a,{"aria-label":"Edit",onClick:function(){return e.edit("asset",t)},className:a.margin},r.a.createElement("i",{className:"far fa-edit",style:{fontSize:"0.7em"}})),r.a.createElement(T.a,{"aria-label":"Info",className:a.margin,onClick:function(){return e.assetInfoButton(t)}},r.a.createElement("i",{className:"fas fa-info-circle",style:{fontSize:"0.7em"}}))))}))),p))),r.a.createElement(yn.a,{label:"Staff",icon:r.a.createElement("i",{className:"fas fa-user-md fa-sm",style:{fontSize:"20px"}}),onClick:this.handleStaffToggle}),r.a.createElement(fa.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.openStaff,onClose:this.handleMenuClose,style:{alignItems:"center",justifyContent:"center",display:"flex"},maxWidth:!1,TransitionComponent:ur},r.a.createElement("div",{className:a.infoDialog},r.a.createElement(Sa.a,null,r.a.createElement(C.a,{variant:"h4",style:{marginLeft:"8px"}},"Staff"),r.a.createElement("div",{style:{marginLeft:"8px",marginTop:"0.5em"}},r.a.createElement(jn.a,{className:a.input,fullWidth:!0,onChange:function(t){return e.search(t,"staff")},placeholder:"Search"})),r.a.createElement("hr",null),r.a.createElement(C.a,{variant:"h6",style:{marginLeft:"8px"}},"Assigned In: ",this.props.map.id),r.a.createElement("hr",null)),r.a.createElement(Ea.a,null,r.a.createElement(Ft.a,{className:a.table},r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,r.a.createElement(zt.a,null,"Name"),r.a.createElement(zt.a,{align:"center"},"Currently At"),r.a.createElement(zt.a,{align:"center"},"Actions"))),r.a.createElement(Wt.a,null,this.state.staff.map(function(t){var n="",i="-";return n=t.highlight?r.a.createElement(T.a,{style:{background:"black",color:"white",opacity:"0.4"},"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("staff",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})):r.a.createElement(T.a,{"aria-label":"Highlight",className:a.margin,onClick:function(){return e.highlight("staff",t)}},r.a.createElement("i",{className:"fas fa-highlighter",style:{fontSize:"0.7em"}})),e.props.deviceLogs.map(function(e){null!=t.beacon&&e.id==t.beacon[0]&&(i=e.map.id)}),r.a.createElement(Yt.a,{key:t.id},r.a.createElement(zt.a,{component:"th",scope:"row"},t.name),r.a.createElement(zt.a,{align:"center"},i),r.a.createElement(zt.a,{align:"right"},n,r.a.createElement(T.a,{"aria-label":"Edit",onClick:function(){return e.edit("staff",t)},className:a.margin},r.a.createElement("i",{className:"far fa-edit",style:{fontSize:"0.7em"}})),r.a.createElement(T.a,{"aria-label":"Info",className:a.margin,onClick:function(){return e.staffInfoButton(t)}},r.a.createElement("i",{className:"fas fa-info-circle",style:{fontSize:"0.7em"}}))))}))),u)))))}}]),t}(n.Component),dr=Object(s.b)(function(e){return{maps:e.maps,map:e.map,devices:e.devices,patients:e.patients,assets:e.assets,staff:e.staff,deviceLogs:e.deviceLogs,ecg:e.ecg,heartrate:e.heartrate,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},editPatient:function(t){return e(qe(t))},addPatient:function(t){return e(Je(t))},removePatient:function(t){return e(Ze(t))},fetchMaps:function(t){return e(ze(t))},loadMap:function(t){return e(He(t))},fetchDevices:function(t){return e(Ge(t))},fetchDeviceLocations:function(t){return e(Ve(t))},loadInfo:function(t){return e(function(e){return{type:"LOAD_INFO",payload:e}}(t))},fetchEcgVitals:function(t){return e(et())},fetchHeartrateVitals:function(t){return e(at())},highlightPatient:function(t){return e(function(e){return{type:"HIGHLIGHT_PATIENT",payload:e}}(t))},highlightStaff:function(t){return e(function(e){return{type:"HIGHLIGHT_STAFF",payload:e}}(t))},highlightAsset:function(t){return e(function(e){return{type:"HIGHLIGHT_ASSET",payload:e}}(t))},fetchSimulationCoordinates:function(t){return e($e())},signOutUser:function(t){return e(Ye())}}})(pr),mr=Object(q.withStyles)(function(e){var t,a;return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"16px 0px 0px 0px"},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},paper:(t={width:"auto",overflow:"auto",maxHeight:"500px",position:"absolute"},Object(J.a)(t,"width",50*e.spacing.unit),Object(J.a)(t,"backgroundColor",e.palette.background.paper),Object(J.a)(t,"boxShadow",e.shadows[5]),Object(J.a)(t,"padding",4*e.spacing.unit),Object(J.a)(t,"outline","none"),t),infoDialog:(a={},Object(J.a)(a,e.breakpoints.between("sm","xl"),{width:"700px"}),Object(J.a)(a,e.breakpoints.down("sm"),{width:"80vw"}),a),input:{flex:1}}})(dr),hr=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.handleSubmit=function(e){e.preventDefault();var t=!1,n=new Date(a.state.startTime),r=new Date(a.state.endTime);if(""==a.state.contactDistance&&(a.setState({distError:!0}),t=!0),""==a.state.name&&(a.setState({nameError:!0}),t=!0),n>r&&(a.setState({error:"Time range is invalid"}),t=!0),!t&&n<=r){var i={name:a.state.name,contactDistance:a.state.contactDistance,startTime:a.state.startTime,endTime:a.state.endTime};a.props.fetchContactTrace(i),a.setState({error:""})}},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.updateStart=function(e){a.setState({startTime:e.target.value})},a.updateEnd=function(e){a.setState({endTime:e.target.value})},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.cancel=function(){a.props.history.push("/home")},a.state={anchorEl:null,auth:!0,name:"",owner:"",image:"",imagePreview:"",imageName:"",ward:"",contactDistance:"",beacon:a.props.beacon,loading:!1,startTime:"2019-04-15T10:30",endTime:"2019-04-15T10:30",contactTraceError:"",error:"",nameError:!1,distError:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){0==this.props.fetching&&1==e.fetching&&null!=this.props.contactTrace|this.props.contactTrace!=e.contactTrace&&null!=this.props.contactTrace?0==this.props.contactTrace.length?this.setState({contactTraceError:"Error: There are no contact tracing data for the specified time range"}):this.props.history.push("/contactTracingResults"):0==this.props.fetching&&1==e.fetching&&null==this.props.contactTrace|this.props.contactTrace!=e.contactTrace&&null==this.props.contactTrace&&this.setState({contactTraceError:"Server Error: Unable to get contact trace"}),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.anchorEl,i=a.auth,o=Boolean(n);this.state.imagePreview,this.state.imageName;return this.props.isAuthenticating?r.a.createElement(Ee.a,null):r.a.createElement("div",{className:t.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:t.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:t.grow,style:{color:"black"}},"Contact Tracing"),i&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":o?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:o,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement("form",{className:t.align,onSubmit:this.handleSubmit},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:t.layout},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Contact Tracing"),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},"Infected"),r.a.createElement(C.a,{variant:"subtitle1",style:{color:"red"}}," ",this.state.contactTraceError,"  "),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Name",placeholder:"Name",autoComplete:"name",variant:"outlined",disabled:this.props.fetching,fullWidth:!0,className:t.textField,onChange:function(t){return e.setState({name:t.target.value})},required:!0,helperText:this.state.nameError?"This field is required":null,error:this.state.nameError})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Contact Distance (m)",placeholder:"Contact Distance (m)",variant:"outlined",disabled:this.props.fetching,fullWidth:!0,className:t.textField,helperText:this.state.distError?"This field is required":null,error:this.state.distError,required:!0,onChange:function(t){return e.setState({contactDistance:t.target.value})}})),r.a.createElement("div",null,r.a.createElement(ct.a,{id:"datetime-local",label:"Start",variant:"outlined",type:"datetime-local",style:{marginRight:"1em",marginTop:"1em"},defaultValue:this.state.startTime,className:t.textField,onChange:this.updateStart,disabled:this.props.fetching,error:""!=this.state.error,InputLabelProps:{shrink:!0}}),r.a.createElement(ct.a,{id:"datetime-local",label:"End",type:"datetime-local",variant:"outlined",style:{marginTop:"1em"},defaultValue:this.state.endTime,error:""!=this.state.error,className:t.textField,onChange:this.updateEnd,disabled:this.props.fetching,InputLabelProps:{shrink:!0}}))),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},this.props.fetching?r.a.createElement(ra.a,{className:t.progress}):r.a.createElement("div",null,r.a.createElement(g.a,{type:"submit",variant:"contained",color:"primary"},"Submit"),r.a.createElement(g.a,{style:{marginLeft:"3em"},onClick:this.cancel},"Cancel")))))))}}]),t}(n.Component),fr=Object(s.b)(function(e){return{beacon:e.beacon,fetching:e.fetching,contactTrace:e.contactTrace,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},fetchingProcess:function(t){return e({type:"FETCHING_PROCESS"})},fetchContactTrace:function(t){return e(Ke(t))},signOutUser:function(t){return e(Ye())}}})(hr),gr=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"}}})(fr),vr=0;function br(e,t,a){return{id:vr+=1,name:e,timestamp:t,location:a}}function Er(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var yr=[{id:"patient",disablePadding:!1,label:"Patient"},{id:"timestamp",disablePadding:!1,label:"Timestamp"},{id:"location",disablePadding:!1,label:"Location"}],Sr=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.onSelectAllClick,t.order),n=t.orderBy;t.numSelected,t.rowCount;return r.a.createElement(Gt.a,null,r.a.createElement(Yt.a,null,yr.map(function(t){return r.a.createElement(zt.a,{key:t.id,padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},r.a.createElement(ta.a,{title:"Sort",placement:"bottom-start",enterDelay:300},r.a.createElement($t.a,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(r.a.Component),wr=function(e){e.numSelected;var t=e.classes;return r.a.createElement(O.a,{className:xt()(t.root)},r.a.createElement("div",{className:t.title},r.a.createElement(C.a,{variant:"h6",id:"tableTitle"},"Potentially Infected")),r.a.createElement("div",{className:t.spacer}))};wr=Object(q.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(aa.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{paddingTop:".5em",flex:"0 0 auto"}}})(wr);var Cr=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"serialno",selected:[],data:[br("Cupcake",98,"Ward 52"),br("Donut",34,"Ward 52")],page:0,rowsPerPage:5},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleSelectAllClick=function(e){e.target.checked?a.setState(function(e){return{selected:e.data.map(function(e){return e.id})}}):a.setState({selected:[]})},a.handleClick=function(e,t,n){var r=a.state.selected,i=r.indexOf(t),o=[];-1===i?o[0]=t:0===i?o=o.concat(r.slice(1)):i===r.length-1?o=o.concat(r.slice(0,-1)):i>0&&(o=o.concat(r.slice(0,i),r.slice(i+1))),a.setState({selected:o}),1===o.length&&a.props.updateTime(n)},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){if(null!=this.props.potential&&e.potential!=this.props.potential){var t=this.props.potential,a=[];t.forEach(function(e){var t=br(e.contact,e.timestamp,e.location);a.push(t)}),this.setState({data:a})}}},{key:"render",value:function(){var e,t,a,n=this,i=this.props.classes,o=this.state,s=o.data,c=o.order,l=o.orderBy,u=o.selected,p=o.rowsPerPage,d=o.page,m=p-Math.min(p,s.length-d*p);return r.a.createElement(ut.a,{className:i.root},r.a.createElement(wr,{numSelected:u.length}),r.a.createElement("div",{className:i.tableWrapper},r.a.createElement(Ft.a,{className:i.table,"aria-labelledby":"tableTitle"},r.a.createElement(Sr,{numSelected:u.length,order:c,orderBy:l,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:s.length}),r.a.createElement(Wt.a,null,(e=s,t=function(e,t){return"desc"===e?function(e,a){return Er(e,a,t)}:function(e,a){return-Er(e,a,t)}}(c,l),a=e.map(function(e,t){return[e,t]}),a.sort(function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(function(e){return e[0]})).slice(d*p,d*p+p).map(function(e){var t=n.isSelected(e.id);return r.a.createElement(Yt.a,{hover:!0,onClick:function(t){return n.handleClick(t,e.id,e.timestamp)},"aria-checked":t,tabIndex:-1,key:e.id,selected:t},r.a.createElement(zt.a,{padding:"default"},e.name),r.a.createElement(zt.a,{component:"th",scope:"row",padding:"default"},e.timestamp),r.a.createElement(zt.a,{padding:"default"},e.location))}),m>0&&r.a.createElement(Yt.a,{style:{height:49*m}},r.a.createElement(zt.a,{colSpan:6}))))),r.a.createElement(Jt.a,{component:"div",count:s.length,rowsPerPage:p,page:d,rowsPerPageOptions:[5,10,15],backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(r.a.Component),xr=Object(s.b)(null,function(e){return{assignBeacon:function(t){return e(Fe(t))}}})(Cr),Or=Object(q.withStyles)(function(e){return{root:{width:"100%",marginTop:3*e.spacing.unit},table:{minWidth:500},tableWrapper:{overflowX:"auto"}}})(xr),kr=a(225),Tr=a.n(kr),jr=(r.a.createElement,"http://137.132.165.139:3000/graphql"),Dr=Object(An.d)({accessToken:"".concat("pk.eyJ1IjoiZnlwZW5nIiwiYSI6ImNqcmFlazM4YjAxejkzeW1wbWg2Zmp2aWsifQ.obOnEjbqcpEWu9HIh6zPlw"),maxZoom:10.5,minZoom:0}),Nr=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){return a.props.fetchMaps(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(jr),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.startPlayback=function(){var e=a.state.value;(e+=1)<a.state.max&&0==a.state.playback&&(a.timer=setInterval(function(){return a.playback()},100),a.setState({playback:!0}))},a.stopTimer=function(){clearInterval(a.timer),a.setState({playback:!1})},a.playback=function(){var e=a.state.value;(e+=1)>a.state.max?a.stopTimer():a.setState({value:e})},a.createFake=function(){var e=[];return e.push({id:"b1",lat:"0.12689939700739615",lng:"0.2535276535309947",map:{id:"MeetingRm"}}),e.push({id:"b2",lat:"0.14689939700739615",lng:"0.2535276535309947",map:{id:"MeetingRm"}}),e.push({id:"b3",lat:"0.192689939700739615",lng:"0.2535276535309947",map:{id:"MeetingRm"}}),e},a.initializeMap=function(e,t){var n=a.props.maps,r="";n.map(function(e){"simulation_ward"==e.id&&((r=JSON.parse(JSON.stringify(e))).coordinates=[[0,.114],[.6217262964,.114],[.6217262964,0],[0,0]])}),""!=r&&a.setState({map:r});var i={coordinates:""!=r?r.coordinates:void 0,type:"image",url:""!=r?r.imageURL:void 0};if(a.setState({sourceOptions:i}),null!=a.props.contactTrace&&(a.updateSlider(),""!=r)){var o=new Ln.a.LngLatBounds(a.__guard__(""!=r?r.coordinates:void 0,function(e){return e[3]}),a.__guard__(""!=r?r.coordinates:void 0,function(e){return e[1]})).getCenter();a.setState({center:o})}},a.updateSlider=function(){var e=a.props.contactTrace.length-1;a.setState({max:e})},a.onStyleLoad=function(e){var t=a.props,n=(t.onLoad,t.map);null!=n&&a.initializeMap(n)},a.getCirclePaint=function(){return{"circle-radius":a.state.circleRadius,"circle-color":"#FFFF00","circle-opacity":.4}},a.getInfectedCircle=function(){return{"circle-radius":a.state.circleRadius,"circle-stroke-width":1.5,"circle-stroke-color":"#FF0000","circle-opacity":0}},a._resize=function(){a.setState({viewport:Object(jt.a)({},a.state.viewport,{width:a.props.width||window.innerWidth,height:"70vh"})})},a._updateViewport=function(e){a.setState({viewport:e})},a.__guard__=function(e,t){return"undefined"!==typeof e&&null!==e?t(e):void 0},a.renderInfectedCircle=function(){var e=a.props.contactTrace[a.state.value],t=[],n=a.props.traceDetails.name;return t.push(r.a.createElement(An.a,{key:a.props.traceDetails.name,coordinates:[e[n].latitude,e[n].longitude],properties:{title:a.props.traceDetails.name,id:a.props.traceDetails.name}})),t},a.renderHighlightDevices=function(){for(var e=a.props.contactTrace[a.state.value],t=[],n=a.props.filterTrace,i=e.timestamp,o=0,s=Object.keys(n);o<s.length;o++){var c=s[o],l=c;i>=n[c]&&null!=e[l]&&t.push(r.a.createElement(An.a,{key:l,coordinates:[e[l].latitude,e[l].longitude],properties:{title:l,id:l}}))}return t},a.renderDevices=function(e){var t=[];if("static"==e)a.state.staticDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.location.lng,e.location.lat],properties:{title:e.id,id:e.id}}))});else{var n=a.props.contactTrace[a.state.value];Object.values(n).map(function(e){"object"===typeof e&&null!==e&&null!=e.beacon&&t.push(r.a.createElement(An.a,{key:e.beacon,coordinates:[e.latitude,e.longitude],properties:{title:e.beacon,id:e.beacon}}))})}return t},a.renderPopup=function(){return a.state.popupInfo&&r.a.createElement(Pn.a,{tipSize:5,anchor:"bottom-right",longitude:a.state.popupInfo.state.longitude,latitude:a.state.popupInfo.state.latitude,onClose:function(){return a.setState({popupInfo:null})},closeOnClick:!0},r.a.createElement("h4",null,a.state.popupInfo.state.fullName),r.a.createElement("p",null,a.state.popupInfo.incidentNumber," ",a.state.popupInfo.disaster," incident(s)"),r.a.createElement("div",{class:"text-center"},r.a.createElement("img",{src:a.state.popupInfo.icon.imgUrl,style:{height:"50px"}})))},a.formatUnix=function(){var e=a.props.contactTrace[a.state.value].key,t=new Date(1e3*e),n=t.getFullYear(),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],i=t.getDate(),o=t.getHours(),s="0"+t.getMinutes(),c="0"+t.getSeconds();return i+"-"+r+"-"+n+" "+o+":"+s.substr(-2)+":"+c.substr(-2)},a.handleChange=function(e,t){a.setState({value:t})},a.state={viewport:{latitude:37.785164,longitude:-100,zoom:2.8,bearing:0,pitch:0,width:500,height:500},popupInfo:null,map:"",sourceOptions:{},center:[0,0],staticDevices:"",mobileDevices:"",circleRadius:20,value:0,max:6,playback:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this._resize),this.fetch(),this._resize(),null!=this.props.map&&this.initializeMap(this.props.map)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"componentDidUpdate",value:function(e){this.props.contactTrace!==e.contactTrace&&this.initializeMap(this.props.contactTrace)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){this.state.viewport;var e=this.props.classes,t=this.state.sourceOptions,a=this.state.center;this.props.map;var n=this.props,i=(n.children,n.onLoad,n.map,n.height,n.width,window.location.origin),o={version:8,name:"custom",sources:{},sprite:"".concat(i,"/mapbox-styles/maki"),glyphs:"".concat(i,"/mapbox-styles/font/{fontstack}/{range}.pbf"),layers:[]};return r.a.createElement("div",null,r.a.createElement(Dr,{style:o,center:a,movingMethod:"jumpTo",ref:this.mapLocation,containerStyle:{height:"70vh",width:"100%"},onStyleLoad:this.onStyleLoad},r.a.createElement(An.b,{type:"symbol",id:"staticDevices",layout:{"icon-image":"triangle-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},""!=this.state.staticDevices?this.renderDevices("static"):null),r.a.createElement(An.b,{type:"circle",paint:this.getInfectedCircle()},null!=this.props.filterTrace?this.renderInfectedCircle():null),r.a.createElement(An.b,{type:"circle",paint:this.getCirclePaint()},null!=this.props.filterTrace?this.renderHighlightDevices():null),r.a.createElement(An.b,{type:"symbol",id:"patientDevices",layout:{"icon-image":"marker-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[.6,.7],"text-anchor":"bottom-left","icon-size":.6}},null!=this.props.contactTrace?this.renderDevices("mobile"):null),""!=this.state.map?r.a.createElement("div",null,r.a.createElement(An.c,{id:"image_source",tileJsonSource:t}),r.a.createElement(An.b,{id:"image_layer",before:"staticDevices",type:"raster",sourceId:"image_source"})):null),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:e.demo,justify:"center",spacing:0,alignItems:"center",style:{overflowX:"hidden"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"subtitle1"},null!=this.props.contactTrace?this.formatUnix():this.state.value),r.a.createElement(Tr.a,{value:this.state.value,min:0,max:this.state.max,step:1,onChange:this.handleChange}),0==this.state.playback?r.a.createElement(g.a,{onClick:this.startPlayback}," Playback "):r.a.createElement(g.a,{onClick:this.stopTimer}," Stop ")))))}}]),t}(n.Component),Pr=Object(s.b)(function(e){return{maps:e.maps,map:e.map,devices:e.devices,deviceLogs:e.deviceLogs,patients:e.patients,contactTrace:e.contactTrace,traceDetails:e.traceDetails,filterTrace:e.filterTrace}},function(e){return{confirmType:function(t){return e(We(t))},fetchMaps:function(t){return e(ze(t))},fetchContactTrace:function(t){return e(Ke(t))}}})(Nr),Ar=Object(q.withStyles)(function(e){var t;return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},demo:(t={padding:"16px 24px 24px"},Object(J.a)(t,e.breakpoints.up("sm"),{width:"560px"}),Object(J.a)(t,e.breakpoints.up("md"),{width:"700px"}),Object(J.a)(t,e.breakpoints.up("lg"),{width:"800px"}),t)}})(Pr),Ir=0;function Lr(e,t,a,n,r){return{id:Ir+=1,name:e,calories:t,fat:a,carbs:n,protein:r}}Lr("Frozen yoghurt",159,6,24,4),Lr("Ice cream sandwich",237,9,37,4.3),Lr("Eclair",262,16,24,6),Lr("Cupcake",305,3.7,67,4.3),Lr("Gingerbread",356,16,49,3.9);var _r=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.findPotential=function(){for(var e=a.props.filterTrace,t=[],n=1,r=e,i=(e.secondary_contacts,0),o=Object.keys(r);i<o.length;i++){var s=o[i],c={contact:s,timestamp:a.formatUnix(r[s]),location:"Ward 52",id:n};n+=1,t.push(c)}a.setState({potential:t})},a.formatDate=function(){var e=a.props.contactTrace,t=e[0].timestamp,n=e[e.length-1].timestamp;return t=a.formatUnix(t),n=a.formatUnix(n),"".concat(t," to ").concat(n)},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.formatUnix=function(e){var t=new Date(1e3*e),a=t.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],r=t.getDate(),i=t.getHours(),o="0"+t.getMinutes(),s="0"+t.getSeconds();return r+"-"+n+"-"+a+" "+i+":"+o.substr(-2)+":"+s.substr(-2)},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.cancel=function(){a.props.history.push("/home")},a.updateTime=function(e){},a.state={anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"",potential:[],contactDistance:"",beacon:a.props.beacon},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"componentDidMount",value:function(){null!=this.props.filterTrace?this.findPotential():this.props.history.push("/contactTracing")}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.auth,i=Boolean(a);this.state.imagePreview,this.state.imageName;return r.a.createElement("div",{className:e.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:e.grow,style:{color:"black"}},"Contact Tracing"),n&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":i?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:e.demo,justify:"center",spacing:0,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Contact Tracing"),r.a.createElement(C.a,{variant:"h5",gutterBottom:!0},"Results")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h6",paragraph:!0},"Infected")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"subtitle1",paragraph:!0},null!=this.props.traceDetails?this.props.traceDetails.name:"Santa Claus")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h6",paragraph:!0},"Contact Distance")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"subtitle1",paragraph:!0},null!=this.props.traceDetails?this.props.traceDetails.contactDistance:null)),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"h6",paragraph:!0},"Length Of Stay")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{variant:"subtitle1",paragraph:!0}," ",null!=this.props.traceDetails?this.formatDate():null)))),r.a.createElement("div",{className:e.layout,style:{width:"auto"}},r.a.createElement(Ar,null)),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:e.demo,justify:"center",spacing:0,alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(Or,{potential:this.state.potential,updateTime:this.updateTime})))))}}]),t}(n.Component),Mr=Object(s.b)(function(e){return{beacon:e.beacon,contactTrace:e.contactTrace,filterTrace:e.filterTrace,traceDetails:e.traceDetails,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},signOutUser:function(t){return e(Ye())}}})(_r),Rr=Object(q.withStyles)(function(e){var t;return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:(t={padding:"16px 24px 24px"},Object(J.a)(t,e.breakpoints.up("sm"),{width:"560px"}),Object(J.a)(t,e.breakpoints.up("md"),{width:"700px"}),Object(J.a)(t,e.breakpoints.up("lg"),{width:"800px"}),t)}})(Mr),Br=a(163),Fr=a.n(Br),Ur=a(145),Wr=a.n(Ur),qr=(a(256),a(121)),zr=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",showLine:!0,borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,borderWidth:"2",lineTension:0,pointRadius:0,data:[]}]},lineChartOptions:{events:[],responsive:!0,maintainAspectRatio:!1,showLine:!0,legend:{display:!1},elements:{},tooltips:{enabled:!0},plugins:{streaming:{frameRate:30}},scales:{xAxes:[{type:"realtime",realtime:{duration:3e4,delay:1e3,pause:!1},ticks:{autoSkip:!1,maxTicksLimit:10}}]}}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=a.value,i=a.timestamp,o=(new Date(i),Object(jt.a)({},n)),s={x:i,y:r};o.data.push(s);var c=Object(jt.a)({},this.state.lineChartData,{datasets:[o]});this.setState({lineChartData:c})}}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e["chart-container"]},r.a.createElement(qr.a,{data:this.state.lineChartData,options:this.state.lineChartOptions}))}}]),t}(r.a.Component),Hr=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(zr),Gr=a(107),Vr=a.n(Gr),Jr=a(108),Zr=a.n(Jr),Yr=a(110),Qr=a.n(Yr),$r=a(109),Kr=a.n($r),Xr=(a(207),a(101)),ei=a.n(Xr),ti=a(128),ai=a.n(ti),ni=(a(174),a(270),a(61)),ri=a(55),ii=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={chartData:{name:"traffic",columns:["time","value"],points:null},timerange:"",tracker:null,trackerValue:"--",trackerEvent:null,lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,borderWidth:"2",lineTension:0,data:[]}]},lineChartOptions:{legend:{display:!1},elements:{},tooltips:{enabled:!0},pan:{enabled:!0,mode:"x"},zoom:{enabled:!0,mode:"x"}}},a.handleTimeRangeChange=function(e){a.setState({timerange:e})},a.handleTrackerChanged=function(e){if(e){var t=new ri.TimeSeries(a.state.chartData).atTime(e),n=new Date(t.begin().getTime()+(t.end().getTime()-t.begin().getTime())/2),r=t.get("value"),i="".concat(r);a.setState({tracker:n,trackerValue:i,trackerEvent:t})}else a.setState({tracker:null,trackerValue:null,trackerEvent:null})},a.renderMarker=function(){return a.state.tracker?r.a.createElement(ni.EventMarker,{type:"point",axis:"axis1",event:a.state.trackerEvent,column:"value",markerLabel:a.state.trackerValue,markerLabelAlign:"left",markerLabelStyle:{fill:"black"},markerRadius:3,markerStyle:{fill:"black"}}):r.a.createElement("g",null)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals&&0!=this.props.vitals.length){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=[],i=this.state.chartData,o=[],s=Object(jt.a)({},i),c=Object(jt.a)({},n);a.map(function(e){var t=e._source.num,a=new Date(e._source.timestamp).toLocaleString("en-GB"),n=t,i=[new Date(e._source.timestamp),t];r.push(i),o.push(a),c.data.push(n)}),s.points=r;var l=Object(jt.a)({},this.state.lineChartData,{datasets:[c],labels:o});this.setState({lineChartData:l}),this.setState({chartData:s});var u=new ri.TimeSeries(s).timerange();this.setState({timerange:u})}}},{key:"render",value:function(){var e="",t="";null!=this.state.chartData.points&&(t=new ri.TimeSeries(this.state.chartData),e=this.state.timerange);return null!=this.state.chartData.points?r.a.createElement("div",null,r.a.createElement(ni.Resizable,null,r.a.createElement(ni.ChartContainer,{enablePanZoom:!0,onTrackerChanged:this.handleTrackerChanged,onTimeRangeChanged:this.handleTimeRangeChange,timeRange:e,width:800},r.a.createElement(ni.ChartRow,{height:"400"},r.a.createElement(ni.YAxis,{id:"axis1",label:"Heart Rate",min:t.min(),max:t.max(),width:"60",type:"linear"}),r.a.createElement(ni.Charts,null,r.a.createElement(ni.LineChart,{axis:"axis1",series:t,style:{value:{normal:{stroke:"steelblue",fill:"none",strokeWidth:2},highlighted:{stroke:"#5a98cb",fill:"none",strokeWidth:2},selected:{stroke:"steelblue",fill:"none",strokeWidth:2},muted:{stroke:"steelblue",fill:"none",opacity:.4,strokeWidth:2}}}})))))):null}}]),t}(r.a.Component),oi=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(ii),si=a(86),ci=a.n(si),li=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={chartData:{name:"traffic",columns:["time","value"],points:null},timerange:"",tracker:null,trackerValue:"--",trackerEvent:null,lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,borderWidth:"2",lineTension:0,data:[]}]},lineChartOptions:{legend:{display:!1},elements:{},tooltips:{enabled:!0},pan:{enabled:!0,mode:"x"},zoom:{enabled:!0,mode:"x"}}},a.handleTimeRangeChange=function(e){a.setState({timerange:e})},a.handleTrackerChanged=function(e){if(e){var t=new ri.TimeSeries(a.state.chartData).atTime(e),n=new Date(t.begin().getTime()+(t.end().getTime()-t.begin().getTime())/2),r=t.get("value"),i="".concat(r);a.setState({tracker:n,trackerValue:i,trackerEvent:t})}else a.setState({tracker:null,trackerValue:null,trackerEvent:null})},a.renderMarker=function(){return a.state.tracker?r.a.createElement(ni.EventMarker,{type:"point",axis:"axis1",event:a.state.trackerEvent,column:"value",markerLabel:a.state.trackerValue,markerLabelAlign:"left",markerLabelStyle:{fill:"black"},markerRadius:3,markerStyle:{fill:"black"}}):r.a.createElement("g",null)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals&&0!=this.props.vitals.length){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=[],i=this.state.chartData,o=[],s=Object(jt.a)({},i),c=Object(jt.a)({},n),l=[];a.map(function(e){var t=e._source.ecgHrPoint,a=new Date(e._source.timestamp).toLocaleString("en-GB"),n=t,i=[new Date(e._source.timestamp),t];r.push(i),o.push(a),"".concat(e._source.timestamp," ,"),l.push(ci()(e._source.timestamp)),c.data.push(n)}),s.points=r;l.map(function(e,t,a){if(null!=a[t+1]){var n=a[t+1]-e;"".concat(n,",")}});var u=Object(jt.a)({},this.state.lineChartData,{datasets:[c],labels:o});this.setState({lineChartData:u}),this.setState({chartData:s});var p=new ri.TimeSeries(s).timerange();this.setState({timerange:p})}}},{key:"render",value:function(){var e="",t="";null!=this.state.chartData.points&&(t=new ri.TimeSeries(this.state.chartData),e=this.state.timerange);return null!=this.state.chartData.points?r.a.createElement("div",null,r.a.createElement(ni.Resizable,null,r.a.createElement(ni.ChartContainer,{enablePanZoom:!0,onTrackerChanged:this.handleTrackerChanged,onTimeRangeChanged:this.handleTimeRangeChange,timeRange:e,width:800},r.a.createElement(ni.ChartRow,{height:"400"},r.a.createElement(ni.YAxis,{id:"axis1",label:"ECG",min:t.min(),max:t.max(),width:"60",type:"linear"}),r.a.createElement(ni.Charts,null,r.a.createElement(ni.LineChart,{axis:"axis1",series:t,style:{value:{normal:{stroke:"steelblue",fill:"none",strokeWidth:2},highlighted:{stroke:"#5a98cb",fill:"none",strokeWidth:2},selected:{stroke:"steelblue",fill:"none",strokeWidth:2},muted:{stroke:"steelblue",fill:"none",opacity:.4,strokeWidth:2}}}})))))):null}}]),t}(r.a.Component),ui=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(li),pi=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={chartData:{name:"traffic",columns:["time","value"],points:null},timerange:"",tracker:null,trackerValue:"--",trackerEvent:null,lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,borderWidth:"2",lineTension:0,data:[]}]},lineChartOptions:{legend:{display:!1},elements:{},tooltips:{enabled:!0},pan:{enabled:!0,mode:"x"},zoom:{enabled:!0,mode:"x"}}},a.handleTimeRangeChange=function(e){a.setState({timerange:e})},a.handleTrackerChanged=function(e){if(e){var t=new ri.TimeSeries(a.state.chartData).atTime(e),n=new Date(t.begin().getTime()+(t.end().getTime()-t.begin().getTime())/2),r=t.get("value"),i="".concat(r);a.setState({tracker:n,trackerValue:i,trackerEvent:t})}else a.setState({tracker:null,trackerValue:null,trackerEvent:null})},a.renderMarker=function(){return a.state.tracker?r.a.createElement(ni.EventMarker,{type:"point",axis:"axis1",event:a.state.trackerEvent,column:"value",markerLabel:a.state.trackerValue,markerLabelAlign:"left",markerLabelStyle:{fill:"black"},markerRadius:3,markerStyle:{fill:"black"}}):r.a.createElement("g",null)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals&&0!=this.props.vitals.length){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=[],i=this.state.chartData,o=[],s=Object(jt.a)({},i),c=Object(jt.a)({},n),l=[];a.map(function(e){var t=e._source.resPoint,a=new Date(e._source.timestamp).toLocaleString("en-GB"),n=t,i=[new Date(e._source.timestamp),t];r.push(i),o.push(a),"".concat(e._source.timestamp," ,"),l.push(ci()(e._source.timestamp)),c.data.push(n)}),s.points=r;l.map(function(e,t,a){if(null!=a[t+1]){var n=a[t+1]-e;"".concat(n,",")}});var u=Object(jt.a)({},this.state.lineChartData,{datasets:[c],labels:o});this.setState({lineChartData:u}),this.setState({chartData:s});var p=new ri.TimeSeries(s).timerange();this.setState({timerange:p})}}},{key:"render",value:function(){var e="",t="";null!=this.state.chartData.points&&(t=new ri.TimeSeries(this.state.chartData),e=this.state.timerange);return null!=this.state.chartData.points?r.a.createElement("div",null,r.a.createElement(ni.Resizable,null,r.a.createElement(ni.ChartContainer,{enablePanZoom:!0,onTrackerChanged:this.handleTrackerChanged,onTimeRangeChanged:this.handleTimeRangeChange,timeRange:e,width:800},r.a.createElement(ni.ChartRow,{height:"400"},r.a.createElement(ni.YAxis,{id:"axis1",label:"Respiration",min:t.min(),max:t.max(),width:"60",type:"linear"}),r.a.createElement(ni.Charts,null,r.a.createElement(ni.LineChart,{axis:"axis1",series:t,style:{value:{normal:{stroke:"steelblue",fill:"none",strokeWidth:2},highlighted:{stroke:"#5a98cb",fill:"none",strokeWidth:2},selected:{stroke:"steelblue",fill:"none",strokeWidth:2},muted:{stroke:"steelblue",fill:"none",opacity:.4,strokeWidth:2}}}})))))):null}}]),t}(r.a.Component),di=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(pi);var mi=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.handleFormat=function(e,t){t!=a.state.chartMode&&null!=t&&a.setState({chartMode:t})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/locationTracking")},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleTabChange=function(e,t){a.setState({tab:t})},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.updateStart=function(e){a.setState({startTime:e.target.value})},a.updateEnd=function(e){a.setState({endTime:e.target.value})},a.cancel=function(){a.props.history.push("/home")},a.submitQuery=function(e){var t=a.state.startTime,n=a.state.endTime,r={size:1e4,sort:[{timestamp:{order:"asc"}}],query:{range:{timestamp:{gte:t+=":00",lte:n+=":00"}}}};Re.a.get("http://137.132.165.161:9200/".concat(e,"/_search?scroll=1m"),{params:{source:JSON.stringify(r),source_content_type:"application/json"}}).then(function(t){var n=t.data.hits.hits,r=[];r=r.concat(n);t.data.hits.total;var i={scroll:"1m",scroll_id:t.data._scroll_id};"ecg"==e&&a.getAPI(i,r,e)})},a.getAPI=function(e,t,n){Re.a.get("http://137.132.165.161:9200/_search/scroll",{params:{source:JSON.stringify(e),source_content_type:"application/json"}}).then(function(e){var r=e.data.hits.hits;t=t.concat(r);var i={scroll:"1m",scroll_id:e.data._scroll_id};e.data.hits.hits.length>0?a.getAPI(i,t,n):a.setState(Object(J.a)({},n,t))})},a.submitForm=function(){new Date(a.state.startTime)<=new Date(a.state.endTime)?(a.submitQuery("ecg"),a.submitQuery("heartrate"),a.setState({error:""})):a.setState({error:"Time range is invalid"})},a.renderPlaybackForm=function(){var e=a.props.classes,t=ci()().format().split("T");t[0],t[1].slice(0,5);return r.a.createElement("div",null,r.a.createElement("form",{className:e.container,noValidate:!0},r.a.createElement(ct.a,{id:"datetime-local",label:"Start",variant:"outlined",type:"datetime-local",style:{marginRight:"1em",marginBottom:"1em"},defaultValue:a.state.startTime,className:e.textField,onChange:a.updateStart,error:""!=a.state.error,InputLabelProps:{shrink:!0}}),r.a.createElement(ct.a,{id:"datetime-local",label:"End",variant:"outlined",type:"datetime-local",defaultValue:a.state.endTime,className:e.textField,onChange:a.updateEnd,error:""!=a.state.error,InputLabelProps:{shrink:!0}}),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"outlined",color:"primary",onClick:a.submitForm,className:e.button},"Fetch"))))},a.state={submittedForm:!1,values:{},anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"",contactDistance:"",tab:0,beacon:a.props.beacon,response:[],chartMode:["live"],endpoint:"https://330f4015.ngrok.io",startTime:"2019-04-15T10:30",endTime:"2019-04-15T10:30",ecg:[],heartrate:[],error:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){""!=this.props.info&&this.setState({name:this.props.info.name})}},{key:"componentDidUpdate",value:function(e,t){this.props.vitals!==e.vitals&&this.setState({vitals:this.props.vitals})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl;t.auth,Boolean(a);return r.a.createElement("div",{className:e.root},this.renderPlaybackForm(),r.a.createElement("div",null," ",r.a.createElement(C.a,{variant:"subtitle1",style:{color:"red"}}," ",this.state.error,"  ")," "),r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"Heart Rate")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(oi,{vitals:this.state.heartrate})))),r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"ECG")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(ui,{vitals:this.state.ecg})))),r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"Respiration")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(di,{vitals:this.state.ecg})))))}}]),t}(n.Component),hi=Object(s.b)(function(e){return{beacon:e.beacon,vitals:e.vitals,info:e.info}},function(e){return{addUsername:function(t){return e(Be(t))},fetchEcgVitals:function(t){return e(et())},fetchHeartrateVitals:function(t){return e(at())}}})(mi),fi=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"1.5rem",flexGrow:"1"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:{padding:"16px 32px 24px"},demoOne:{padding:"16px 32px 5px"},toggleContainer:{height:56,padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px"),display:"flex",alignItems:"center",justifyContent:"flex-start",margin:"".concat(e.spacing.unit,"px 0")},button:{margin:e.spacing.unit}}})(hi),gi=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,borderWidth:"2",pointRadius:0,lineTension:0,data:[]}]},lineChartOptions:{events:[],responsive:!0,maintainAspectRatio:!1,legend:{display:!1},elements:{},tooltips:{enabled:!0},plugins:{streaming:{frameRate:30}},scales:{xAxes:[{type:"realtime",realtime:{duration:3e4,delay:1e3,pause:!1},ticks:{autoSkip:!1,maxTicksLimit:10}}]}}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=Object(jt.a)({},n);a.map(function(e){var t=e.ecgHrPoint,a=e.timestamp,n=(new Date(a),{x:a,y:t});r.data.push(n)});var i=Object(jt.a)({},this.state.lineChartData,{datasets:[r]});this.setState({lineChartData:i})}}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e["chart-container"]},r.a.createElement(qr.a,{data:this.state.lineChartData,options:this.state.lineChartOptions}))}}]),t}(r.a.Component),vi=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(gi),bi=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={lineChartData:{datasets:[{label:"BTC-USD",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:a.props.theme.palette.primary.main,pointBackgroundColor:a.props.theme.palette.secondary.main,pointBorderColor:a.props.theme.palette.secondary.main,pointRadius:0,borderWidth:"2",lineTension:0,data:[]}]},lineChartOptions:{events:[],responsive:!0,maintainAspectRatio:!1,legend:{display:!1},elements:{},tooltips:{enabled:!0},plugins:{streaming:{frameRate:30}},scales:{xAxes:[{type:"realtime",realtime:{duration:3e4,delay:1e3,pause:!1},ticks:{autoSkip:!1,maxTicksLimit:10}}]}}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props.vitals!==e.vitals&&null!=this.props.vitals){var a=this.props.vitals,n=this.state.lineChartData.datasets[0],r=Object(jt.a)({},n);a.map(function(e){var t=e.resPoint,a=e.timestamp,n=(new Date(a),{x:a,y:t});r.data.push(n)});var i=Object(jt.a)({},this.state.lineChartData,{datasets:[r]});this.setState({lineChartData:i})}}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e["chart-container"]},r.a.createElement(qr.a,{data:this.state.lineChartData,options:this.state.lineChartOptions}))}}]),t}(r.a.Component),Ei=Object(q.withStyles)(function(e){return{"chart-container":{height:400}}},{withTheme:!0})(bi),yi=(r.a.createElement,"http://137.132.165.139:3000/api"),Si="http://137.132.165.139:3000/graphql",wi=Object(An.d)({accessToken:"".concat("pk.eyJ1IjoiZnlwZW5nIiwiYSI6ImNqcmFlazM4YjAxejkzeW1wbWg2Zmp2aWsifQ.obOnEjbqcpEWu9HIh6zPlw"),maxZoom:13,minZoom:8}),Ci=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.state.loading&&a.getDeviceLogs(),a.props.fetchMaps(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(Si),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.getDeviceLogs=function(e){return Re()({method:"get",url:"".concat(yi,"/Devices/logs"),headers:{"Content-Type":"application/json"}}).then(function(e){a.props.fetchDeviceLocations(e.data)})},a.mapgl=function(){return a.refs.map.getChildContext().map},a.getChildContext=function(){return{map:a.map}},a.createBeaconMarkers=function(e){var t=a.state.map;if(null!=e&&(t=e),""!=t){var n=a.props.deviceLogs.filter(function(e){return e.map.id==t.id}),r=[],i=[],o=[];(n=n.filter(function(e){return e.id==a.props.info.beacon[0]})).map(function(e){"Patient"==a.props.info.type?a.props.patients.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,r.push(a)}}):"Asset"==a.props.info.type?a.props.assets.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,o.push(a)}}):a.props.staff.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,i.push(a)}})}),a.setState({mobileDevices:r}),a.setState({staffDevices:i}),a.setState({assetDevices:o})}},a.initializeMap=function(e,t){a.setState({initial:e}),a.setState({map:e});var n={coordinates:null!=e?e.coordinates:void 0,type:"image",url:null!=e?e.imageURL:void 0};if(a.setState({sourceOptions:n}),""!=e&&""!=a.props.info&&null!=a.props.info){var r=new Ln.a.LngLatBounds(a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[3]}),a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[1]})).getCenter();a.setState({center:r});var i=a.props.deviceLogs.filter(function(t){return t.map.id==e.id});i=i.filter(function(e){return e.id==a.props.info.beacon[0]});var o=[],s=[],c=[];i.map(function(e){"Patient"==a.props.info.type?a.props.patients.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,o.push(a)}}):"Asset"==a.props.info.type?a.props.assets.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,s.push(a)}}):a.props.staff.forEach(function(t){if(null!=t.beacon&&e.id==t.beacon[0]){var a=JSON.parse(JSON.stringify(e));a.id=t.name,c.push(a)}})}),a.setState({mobileDevices:o}),a.setState({assetDevices:s}),a.setState({staffDevices:c});var l=a.props.devices.filter(function(e){return"static"==e.type});l=(l=l.filter(function(e){return null!=e.location})).filter(function(t){return t.location.map.id==e.id}),a.setState({staticDevices:l}),a.setState({loading:!1}),a.createBeaconMarkers(e)}},a.onStyleLoad=function(e){var t=a.props,n=(t.onLoad,t.map);null!=n&&a.initializeMap(n)},a.getCirclePaint=function(){return{"circle-radius":a.state.circleRadius,"circle-color":"#FFFF00","circle-opacity":.4}},a._resize=function(){a.setState({viewport:Object(jt.a)({},a.state.viewport,{width:"100%",height:"70vh"})})},a._updateViewport=function(e){a.setState({viewport:e})},a.__guard__=function(e,t){return"undefined"!==typeof e&&null!==e?t(e):void 0},a.renderHighlightDevices=function(){for(var e=a.props.patients,t=a.state.mobileDevices,n=[],i=function(a){t.map(function(t){e[a].beacon==t.id&&1==e[a].highlight&&n.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))})},o=0;o<e.length;o++)i(o);return n},a.renderDevices=function(e){var t=[];return"static"==e?a.state.staticDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.location.lng,e.location.lat],properties:{title:e.id,id:e.id}}))}):a.state.mobileDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.lng,e.lat],properties:{title:e.id,id:e.id}}))}),console.log(t),t},a.renderPopup=function(){return a.state.popupInfo&&r.a.createElement(Pn.a,{tipSize:5,anchor:"bottom-right",longitude:a.state.popupInfo.state.longitude,latitude:a.state.popupInfo.state.latitude,onClose:function(){return a.setState({popupInfo:null})},closeOnClick:!0},r.a.createElement("h4",null,a.state.popupInfo.state.fullName),r.a.createElement("p",null,a.state.popupInfo.incidentNumber," ",a.state.popupInfo.disaster," incident(s)"),r.a.createElement("div",{class:"text-center"},r.a.createElement("img",{src:a.state.popupInfo.icon.imgUrl,style:{height:"50px"}})))},a.renderStaffDevices=function(){var e=[];return a.state.staffDevices.map(function(t){e.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))}),e},a.renderAssetDevices=function(){var e=[];return a.state.assetDevices.map(function(t){e.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))}),e},a.state={viewport:{latitude:37.785164,longitude:-100,zoom:2.8,bearing:0,pitch:0,width:500,height:500},popupInfo:null,map:"",loading:!0,sourceOptions:{},center:[-.2416815,51.5285582],staticDevices:"",mobileDevices:[],assetDevices:[],staffDevices:[],circleRadius:30,loadingStep:1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.deviceLogs!==e.deviceLogs){if(""==this.state.map&&1==this.state.loading){var n="b1";""!=this.props.info&&null!=this.props.info&&(n=this.props.info.beacon[0]);var r="";this.props.deviceLogs.map(function(e){e.id==n&&(r=e.map.id)}),this.props.maps.map(function(e){if(e.id==r){r=e;var t=JSON.parse(JSON.stringify(e));a.setState({map:t})}}),this.initializeMap(r),this.setState({loading:!1}),this.timer=setInterval(function(){return a.getDeviceLogs()},1e3)}this.createBeaconMarkers()}}},{key:"getChildContext",value:function(){return{map:this.state.map}}},{key:"render",value:function(){this.state.viewport;var e=this.state.sourceOptions,t=this.state.center;this.props.map;var a=this.props,n=(a.children,a.onLoad,a.map,a.height,a.width,window.location.origin),i={version:8,name:"custom",sources:{},sprite:"".concat(n,"/mapbox-styles/maki"),glyphs:"".concat(n,"/mapbox-styles/font/{fontstack}/{range}.pbf"),layers:[]};return r.a.createElement("div",null,r.a.createElement(wi,{style:i,center:t,movingMethod:"jumpTo",ref:this.mapLocation,containerStyle:{height:"70vh",width:"100%"},onStyleLoad:this.onStyleLoad},r.a.createElement(An.b,{type:"symbol",id:"staticDevices",layout:{"icon-image":"triangle-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}}),r.a.createElement(An.b,{type:"circle",paint:this.getCirclePaint()}),r.a.createElement(An.b,{type:"symbol",id:"patientDevices",layout:{"icon-image":"marker-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderDevices("mobile")),r.a.createElement(An.b,{type:"symbol",id:"staffDevices",layout:{"icon-image":"hospital-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderStaffDevices()),r.a.createElement(An.b,{type:"symbol",id:"assetDevices",layout:{"icon-image":"suitcase-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderAssetDevices()),""!=this.state.map?r.a.createElement(An.c,{id:"image_source",tileJsonSource:e}):null,r.a.createElement(An.b,{id:"image_layer",before:"staticDevices",type:"raster",sourceId:"image_source"})),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0,style:{marginTop:"1em"}},""!=this.state.map?"Location: ".concat(this.state.map.id):null," "))}}]),t}(n.Component),xi=Object(s.b)(function(e){return{maps:e.maps,devices:e.devices,deviceLogs:e.deviceLogs,patients:e.patients,assets:e.assets,staff:e.staff,info:e.info}},function(e){return{confirmType:function(t){return e(We(t))},fetchMaps:function(t){return e(ze(t))},fetchDeviceLocations:function(t){return e(Ve(t))}}})(Ci),Oi=(r.a.createElement,"http://137.132.165.139:3000/api"),ki="http://137.132.165.139:3000/graphql",Ti=Object(An.d)({accessToken:"".concat("pk.eyJ1IjoiZnlwZW5nIiwiYSI6ImNqcmFlazM4YjAxejkzeW1wbWg2Zmp2aWsifQ.obOnEjbqcpEWu9HIh6zPlw"),maxZoom:13,minZoom:8}),ji=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).startPlayback=function(){var e=a.state.value;(e+=1)<a.state.max&&0==a.state.playback&&(a.timer=setInterval(function(){return a.playback()},100),a.setState({playback:!0}))},a.stopTimer=function(){clearInterval(a.timer),a.setState({playback:!1})},a.playback=function(){var e=a.state.value;(e+=1)>a.state.max?a.stopTimer():a.handleChange("",e)},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.state.loading;a.props.fetchMaps(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(ki),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.updateSlider=function(){var e=a.props.locationData.length-1;a.setState({max:e})},a.getDeviceLogs=function(e){return Re()({method:"get",url:"".concat(Oi,"/Devices/logs"),headers:{"Content-Type":"application/json"}}).then(function(e){a.props.fetchDeviceLocations(e.data)})},a.mapgl=function(){return a.refs.map.getChildContext().map},a.getChildContext=function(){return{map:a.map}},a.createBeaconMarkers=function(e){var t=a.state.map;if(null!=e&&(t=e),""!=t){var n=[],r=JSON.parse(JSON.stringify(a.props.locationData[a.state.value]._source));""!=a.props.info&&null!=a.props.info&&(r.id=a.props.info.name),n.push(r),a.setState({mobileDevices:n})}},a.initializeMap=function(e,t){a.setState({initial:e}),a.setState({map:e});var n={coordinates:null!=e?e.coordinates:void 0,type:"image",url:null!=e?e.imageURL:void 0};if(a.setState({sourceOptions:n}),""!=e){var r=new Ln.a.LngLatBounds(a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[3]}),a.__guard__(null!=e?e.coordinates:void 0,function(e){return e[1]})).getCenter();a.setState({center:r});var i=a.props.deviceLogs.filter(function(t){return t.map.id==e.id}),o=[];i.map(function(e){a.props.patients.forEach(function(t){if(e.id==t.beacon){var a=JSON.parse(JSON.stringify(e));a.id=t.name,o.push(a)}})}),a.setState({mobileDevices:o});var s=a.props.devices.filter(function(e){return"static"==e.type});s=(s=s.filter(function(e){return null!=e.location})).filter(function(t){return t.location.map.id==e.id}),a.setState({staticDevices:s}),a.setState({loading:!1}),a.createBeaconMarkers(e)}},a.onStyleLoad=function(e){var t=a.props,n=(t.onLoad,t.map);null!=n&&a.initializeMap(n)},a.getCirclePaint=function(){return{"circle-radius":a.state.circleRadius,"circle-color":"#FFFF00","circle-opacity":.4}},a._resize=function(){a.setState({viewport:Object(jt.a)({},a.state.viewport,{width:"100%",height:"70vh"})})},a._updateViewport=function(e){a.setState({viewport:e})},a.__guard__=function(e,t){return"undefined"!==typeof e&&null!==e?t(e):void 0},a.renderHighlightDevices=function(){for(var e=a.props.patients,t=a.state.mobileDevices,n=[],i=function(a){t.map(function(t){e[a].beacon==t.id&&1==e[a].highlight&&n.push(r.a.createElement(An.a,{key:t.id,coordinates:[t.lng,t.lat],properties:{title:t.id,id:t.id}}))})},o=0;o<e.length;o++)i(o);return n},a.renderDevices=function(e){var t=[];return"static"==e?a.state.staticDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.location.lng,e.location.lat],properties:{title:e.id,id:e.id}}))}):a.state.mobileDevices.map(function(e){t.push(r.a.createElement(An.a,{key:e.id,coordinates:[e.lng,e.lat],properties:{title:e.id,id:e.id}}))}),t},a.formatUnix=function(){var e=a.props.locationData[a.state.value]._source.time/1e3,t=new Date(1e3*e),n=t.getFullYear(),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],i=t.getDate(),o=t.getHours(),s="0"+t.getMinutes(),c="0"+t.getSeconds();return i+"-"+r+"-"+n+" "+o+":"+s.substr(-2)+":"+c.substr(-2)},a.handleChange=function(e,t){if(a.setState({value:t}),a.props.locationData[t]._source.map.id!=a.state.map.id){var n="";a.props.maps.map(function(e){if(e.id==a.props.locationData[a.state.value]._source.map.id){n=e;var t=JSON.parse(JSON.stringify(e));a.setState({map:t})}}),a.initializeMap(n)}a.createBeaconMarkers()},a.renderPopup=function(){return a.state.popupInfo&&r.a.createElement(Pn.a,{tipSize:5,anchor:"bottom-right",longitude:a.state.popupInfo.state.longitude,latitude:a.state.popupInfo.state.latitude,onClose:function(){return a.setState({popupInfo:null})},closeOnClick:!0},r.a.createElement("h4",null,a.state.popupInfo.state.fullName),r.a.createElement("p",null,a.state.popupInfo.incidentNumber," ",a.state.popupInfo.disaster," incident(s)"),r.a.createElement("div",{class:"text-center"},r.a.createElement("img",{src:a.state.popupInfo.icon.imgUrl,style:{height:"50px"}})))},a.state={viewport:{latitude:37.785164,longitude:-100,zoom:2.8,bearing:0,pitch:0,width:500,height:500},popupInfo:null,map:"",loading:!0,sourceOptions:{},center:[-.2416815,51.5285582],staticDevices:"",mobileDevices:[],circleRadius:30,value:0,max:6,playback:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.timer=null}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.locationData!=e.locationData){if(this.updateSlider(),""==this.state.map&&1==this.state.loading&&0!=this.props.locationData.length){var n="",r=this.props.locationData;this.props.maps.map(function(e){if(e.id==r[a.state.value]._source.map.id){n=e;var t=JSON.parse(JSON.stringify(e));a.setState({map:t})}}),this.initializeMap(n),this.setState({loading:!1})}this.createBeaconMarkers()}}},{key:"getChildContext",value:function(){return{map:this.state.map}}},{key:"render",value:function(){this.state.viewport;var e=this.state.sourceOptions,t=this.state.center;this.props.map;var a=this.props,n=(a.children,a.onLoad,a.map,a.height,a.width,window.location.origin),i={version:8,name:"custom",sources:{},sprite:"".concat(n,"/mapbox-styles/maki"),glyphs:"".concat(n,"/mapbox-styles/font/{fontstack}/{range}.pbf"),layers:[]};return r.a.createElement("div",null,r.a.createElement(Ti,{style:i,center:t,movingMethod:"jumpTo",ref:this.mapLocation,containerStyle:{height:"70vh",width:"100%"},onStyleLoad:this.onStyleLoad},r.a.createElement(An.b,{type:"symbol",id:"staticDevices",layout:{"icon-image":"triangle-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}}),r.a.createElement(An.b,{type:"circle",paint:this.getCirclePaint()},this.renderHighlightDevices()),r.a.createElement(An.b,{type:"symbol",id:"patientDevices",layout:{"icon-image":"marker-15","icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-field":"{title}","text-font":["Open Sans Semibold"],"text-offset":[0,.8],"text-anchor":"top"}},this.renderDevices("mobile")),""!=this.state.map?r.a.createElement(An.c,{id:"image_source",tileJsonSource:e}):null,r.a.createElement(An.b,{id:"image_layer",before:"staticDevices",type:"raster",sourceId:"image_source"})),""!=this.state.map?r.a.createElement("div",null,0==this.state.playback?r.a.createElement(g.a,{onClick:this.startPlayback}," Playback "):r.a.createElement(g.a,{onClick:this.stopTimer}," Stop "),r.a.createElement(C.a,{variant:"subtitle1"},0!=this.props.locationData.length?this.formatUnix():this.state.value),r.a.createElement(Tr.a,{value:this.state.value,min:0,max:this.state.max,step:1,onChange:this.handleChange}),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0,style:{marginTop:"1em"}},0!=this.props.locationData.length?"Location: ".concat(this.props.locationData[this.state.value]._source.map.id):null," ")):null)}}]),t}(n.Component),Di=Object(s.b)(function(e){return{maps:e.maps,devices:e.devices,deviceLogs:e.deviceLogs,patients:e.patients,info:e.info}},function(e){return{confirmType:function(t){return e(We(t))},fetchMaps:function(t){return e(ze(t))},fetchDeviceLocations:function(t){return e(Ve(t))}}})(ji);var Ni=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.handleFormat=function(e,t){t!=a.state.chartMode&&null!=t&&a.setState({chartMode:t})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/locationTracking")},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleTabChange=function(e,t){a.setState({tab:t})},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.updateStart=function(e){a.setState({startTime:e.target.value})},a.updateEnd=function(e){a.setState({endTime:e.target.value})},a.cancel=function(){a.props.history.push("/home")},a.submitQuery=function(e){var t="b1";if(""!=a.props.info&&"None"!=a.props.info[0]){t=a.props.info.beacon[0];var n=a.state.startTime,r=a.state.endTime,i={size:1e4,sort:[{"@timestamp":{order:"asc"}}],query:{bool:{must:[{type:{value:"position-update"}},{match:{id:t}},{range:{"@timestamp":{gte:n+=":00",lte:r+=":00",time_zone:"+08:00"}}}]}}};Re.a.get("http://137.132.165.139:9200/zmq/_search?scroll=1m",{params:{source:JSON.stringify(i),source_content_type:"application/json"}}).then(function(e){var t=e.data.hits.hits,n=[];n=n.concat(t);e.data.hits.total;var r={scroll:"1m",scroll_id:e.data._scroll_id};a.getAPI(r,n)})}},a.getAPI=function(e,t){Re.a.get("http://137.132.165.139:9200/_search/scroll",{params:{source:JSON.stringify(e),source_content_type:"application/json"}}).then(function(e){var n=e.data.hits.hits;t=t.concat(n);var r={scroll:"1m",scroll_id:e.data._scroll_id};e.data.hits.hits.length>0?a.getAPI(r,t):a.setState({zmq:t})})},a.submitForm=function(){a.submitQuery("zmq")},a.renderPlaybackForm=function(){var e=a.props.classes,t=ci()().format().split("T");t[0],t[1].slice(0,5);return r.a.createElement("div",null,r.a.createElement("form",{className:e.container,noValidate:!0},r.a.createElement(ct.a,{id:"datetime-local",label:"Start",variant:"outlined",type:"datetime-local",style:{marginRight:"1em",marginBottom:"1em"},defaultValue:a.state.startTime,className:e.textField,onChange:a.updateStart,InputLabelProps:{shrink:!0}}),r.a.createElement(ct.a,{id:"datetime-local",label:"End",variant:"outlined",type:"datetime-local",defaultValue:a.state.endTime,className:e.textField,onChange:a.updateEnd,InputLabelProps:{shrink:!0}}),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"outlined",color:"primary",onClick:a.submitForm,className:e.button},"Fetch"))))},a.state={submittedForm:!1,values:{},anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"",contactDistance:"",tab:0,beacon:a.props.beacon,response:[],chartMode:["live"],endpoint:"https://330f4015.ngrok.io",startTime:"2019-04-15T10:30",endTime:"2019-04-15T10:30",ecg:[],heartrate:[],zmq:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){""!=this.props.info&&this.setState({name:this.props.info.name})}},{key:"componentDidUpdate",value:function(e,t){this.props.vitals!==e.vitals&&this.setState({vitals:this.props.vitals})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl;t.auth,Boolean(a);return r.a.createElement("div",{className:e.root},this.renderPlaybackForm(),r.a.createElement(Di,{locationData:this.state.zmq}))}}]),t}(n.Component),Pi=Object(s.b)(function(e){return{beacon:e.beacon,vitals:e.vitals,info:e.info}},function(e){return{addUsername:function(t){return e(Be(t))},fetchEcgVitals:function(t){return e(et())},fetchHeartrateVitals:function(t){return e(at())}}})(Ni),Ai=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"1.5rem",flexGrow:"1"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:{padding:"16px 32px 24px"},demoOne:{padding:"16px 32px 5px"},toggleContainer:{height:56,padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px"),display:"flex",alignItems:"center",justifyContent:"flex-start",margin:"".concat(e.spacing.unit,"px 0")},button:{margin:e.spacing.unit}}})(Pi),Ii=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.handleFormat=function(e,t){t!=a.state.chartMode&&null!=t&&a.setState({chartMode:t})},a.handleMapFormat=function(e,t){t!=a.state.mapMode&&null!=t&&a.setState({mapMode:t})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/locationTracking")},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleTabChange=function(e,t){a.setState({tab:t})},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.updateStart=function(e){a.setState({startTime:e.target.value})},a.updateEnd=function(e){a.setState({endTime:e.target.value})},a.cancel=function(){a.props.history.push("/home")},a.submitQuery=function(){var e={size:1e4,sort:[{timestamp:{order:"asc"}}],query:{range:{timestamp:{gte:a.state.startTime,lte:a.state.endTime}}}};Re.a.get("http://localhost:9200/_search",{params:{source:JSON.stringify(e),source_content_type:"application/json"}}).then(function(e){a.setState({playbackRes:e.data.hits.hits})})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.renderPlaybackForm=function(){var e=a.props.classes;return r.a.createElement("div",null,r.a.createElement("form",{className:e.container,noValidate:!0},r.a.createElement(ct.a,{id:"datetime-local",label:"Start",type:"datetime-local",defaultValue:"2019-05-24T10:30",className:e.textField,onChange:a.updateStart,InputLabelProps:{shrink:!0}}),r.a.createElement(ct.a,{id:"datetime-local",label:"End",type:"datetime-local",defaultValue:"2019-05-24T10:30",className:e.textField,onChange:a.updateEnd,InputLabelProps:{shrink:!0}}),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"outlined",color:"primary",onClick:a.submitQuery,className:e.button},"Fetch"))))},a.state={loading:!1,values:{},anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"",contactDistance:"",tab:0,beacon:a.props.beacon,response:[],chartMode:["live"],mapMode:["live"],endpoint:"https://330f4015.ngrok.io",startTime:"2019-03-11T15:38:48.033972",endTime:"2019-03-11T15:38:49.271003",playbackRes:[],ecg:[],heartrate:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.setState({loading:!0}),""!=this.props.info){this.setState({name:this.props.info.name}),this.setState({devices:this.props.info.devices});var t=this.props.info.devices;null!=t&&"None"!=t[0]&&t.map(function(t){"e"==t.id.charAt(0)&&e.props.fetchSpecificEcgVitals(t.uuid),"h"==t.id.charAt(0)&&e.props.fetchSpecificHeartrateVitals(t.uuid)})}else this.props.history.push("/locationTracking")}},{key:"componentWillUnmount",value:function(){var e=this,t=this.props.info.devices;null!=t&&"None"!=t[0]&&t.map(function(t){"e"==t.id.charAt(0)&&e.props.removeListenerSpecificEcgVitals(t.uuid),"h"==t.id.charAt(0)&&e.props.removeListenerSpecificHeartrateVitals(t.uuid)})}},{key:"componentDidUpdate",value:function(e,t){this.props.ecg!==e.ecg&&this.setState({ecg:this.props.ecg}),this.props.heartrate!==e.heartrate&&this.setState({heartrate:this.props.heartrate}),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.auth,i=Boolean(a);return r.a.createElement("div",{className:e.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:e.grow,style:{color:"black"}},"Status Tracking"),n&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":i?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement(S.a,{container:!0,justify:"left"},r.a.createElement(S.a,{container:!0,className:e.demoOne,spacing:0,alignItems:"center"},r.a.createElement(g.a,{size:"small",onClick:this.backToMap},"Back To Map"))),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:e.demo,justify:"center",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(I.a,{className:e.card},r.a.createElement(R.a,null,r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},this.state.name),r.a.createElement(Fr.a,{value:this.state.tab,onChange:this.handleTabChange,indicatorColor:"primary",textColor:"primary",variant:"fullWidth"},r.a.createElement(Wr.a,{label:"Vitals"}),r.a.createElement(Wr.a,{label:"Location"}))),0==this.state.tab?r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:e.toggleContainer},r.a.createElement(ai.a,{value:this.state.chartMode,exclusive:!0,onChange:this.handleFormat},r.a.createElement(ei.a,{value:"live"},"Live"),r.a.createElement(ei.a,{value:"playback"},"Playback"))),"playback"==this.state.chartMode?r.a.createElement(fi,null):r.a.createElement("div",null,r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"Heart Rate")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(Hr,{vitals:this.state.heartrate})))),r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"ECG")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(vi,{vitals:this.state.ecg})))),r.a.createElement(Vr.a,null,r.a.createElement(Zr.a,{expandIcon:r.a.createElement(Kr.a,null)},r.a.createElement(C.a,{variant:"subtitle1",gutterBottom:!0},"Respiration")),r.a.createElement(Qr.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(Ei,{vitals:this.state.ecg})))))):r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:e.toggleContainer},r.a.createElement(ai.a,{value:this.state.mapMode,exclusive:!0,onChange:this.handleMapFormat},r.a.createElement(ei.a,{value:"live"},"Live"),r.a.createElement(ei.a,{value:"playback"},"Playback"))),"live"==this.state.mapMode?r.a.createElement(xi,null):r.a.createElement(Ai,null)))))),r.a.createElement(S.a,{container:!0,justify:"left"},r.a.createElement(S.a,{container:!0,className:e.demoOne,spacing:0,alignItems:"center"},r.a.createElement(g.a,{size:"small",onClick:this.backToMap,style:{marginBottom:"1em"}},"Back To Map"))))}}]),t}(n.Component),Li=Object(s.b)(function(e){return{beacon:e.beacon,ecg:e.ecg,info:e.info,heartrate:e.heartrate,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},fetchEcgVitals:function(t){return e(et())},fetchHeartrateVitals:function(t){return e(at())},fetchSpecificHeartrateVitals:function(t){return e(nt(t))},removeListenerSpecificHeartrateVitals:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:De.child(e).off();case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},fetchSpecificEcgVitals:function(t){return e(tt(t))},removeListenerSpecificEcgVitals:function(t){return e(function(e){return t=Object(we.a)(Se.a.mark(function t(a){return Se.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:je.child(e).off();case 1:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t}(t))},signOutUser:function(t){return e(Ye())}}})(Ii),_i=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"1.5rem",flexGrow:"1"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:{padding:"16px 32px 24px"},demoOne:{padding:"16px 32px 5px"},toggleContainer:{height:56,padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px"),display:"flex",alignItems:"center",justifyContent:"flex-start",margin:"".concat(e.spacing.unit,"px 0")},button:{margin:e.spacing.unit}}})(Li),Mi=0;function Ri(e,t,a,n,r){return{id:Mi+=1,name:e,calories:t,fat:a,carbs:n,protein:r}}Ri("Frozen yoghurt",159,6,24,4),Ri("Ice cream sandwich",237,9,37,4.3),Ri("Eclair",262,16,24,6),Ri("Cupcake",305,3.7,67,4.3),Ri("Gingerbread",356,16,49,3.9);var Bi=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.handleFormat=function(e,t){t!=a.state.chartMode&&null!=t&&a.setState({chartMode:t})},a.handleMapFormat=function(e,t){t!=a.state.mapMode&&null!=t&&a.setState({mapMode:t})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/locationTracking")},a.handleSubmit=function(e){e.preventDefault(),a.props.history.push("/home")},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleTabChange=function(e,t){a.setState({tab:t})},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.updateStart=function(e){a.setState({startTime:e.target.value})},a.updateEnd=function(e){a.setState({endTime:e.target.value})},a.cancel=function(){a.props.history.push("/home")},a.submitQuery=function(){var e={size:1e4,sort:[{timestamp:{order:"asc"}}],query:{range:{timestamp:{gte:a.state.startTime,lte:a.state.endTime}}}};Re.a.get("http://localhost:9200/_search",{params:{source:JSON.stringify(e),source_content_type:"application/json"}}).then(function(e){a.setState({playbackRes:e.data.hits.hits})})},a.renderPlaybackForm=function(){var e=a.props.classes;return r.a.createElement("div",null,r.a.createElement("form",{className:e.container,noValidate:!0},r.a.createElement(ct.a,{id:"datetime-local",label:"Start",type:"datetime-local",defaultValue:"2017-05-24T10:30",className:e.textField,onChange:a.updateStart,InputLabelProps:{shrink:!0}}),r.a.createElement(ct.a,{id:"datetime-local",label:"End",type:"datetime-local",defaultValue:"2017-05-24T10:30",className:e.textField,onChange:a.updateEnd,InputLabelProps:{shrink:!0}}),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"outlined",color:"primary",onClick:a.submitQuery,className:e.button},"Fetch"))))},a.state={loading:!1,values:{},anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"",contactDistance:"",tab:0,beacon:a.props.beacon,response:[],chartMode:["live"],mapMode:["live"],endpoint:"https://330f4015.ngrok.io",startTime:"2019-03-11T15:38:48.033972",endTime:"2019-03-11T15:38:49.271003",playbackRes:[],ecg:[],heartrate:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.setState({loading:!0}),""!=this.props.info){this.setState({name:this.props.info.name}),this.setState({devices:this.props.info.devices});var t=this.props.info.devices;null!=t&&"None"!=t[0]&&t.map(function(t){"e"==t.id.charAt(0)&&e.props.fetchSpecificEcgVitals(t.uuid),"h"==t.id.charAt(0)&&e.props.fetchSpecificHeartrateVitals(t.uuid)})}else this.props.history.push("/locationTracking")}},{key:"componentDidUpdate",value:function(e,t){this.props.ecg!==e.ecg&&this.setState({ecg:this.props.ecg}),this.props.heartrate!==e.heartrate&&this.setState({heartrate:this.props.heartrate}),0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.anchorEl,n=t.auth,i=Boolean(a);return r.a.createElement("div",{className:e.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:e.grow,style:{color:"black"}},"Status Tracking"),n&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":i?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement(S.a,{container:!0,justify:"left"},r.a.createElement(S.a,{container:!0,className:e.demoOne,spacing:0,alignItems:"center"},r.a.createElement(g.a,{size:"small",onClick:this.backToMap},"Back To Map"))),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:e.demo,justify:"center",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(I.a,{className:e.card},r.a.createElement(R.a,null,r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},this.state.name)),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement("div",{className:e.toggleContainer},r.a.createElement(ai.a,{value:this.state.mapMode,exclusive:!0,onChange:this.handleMapFormat},r.a.createElement(ei.a,{value:"live"},"Live"),r.a.createElement(ei.a,{value:"playback"},"Playback"))),"live"==this.state.mapMode?r.a.createElement(xi,null):r.a.createElement(Ai,null)))))),r.a.createElement(S.a,{container:!0,justify:"left"},r.a.createElement(S.a,{container:!0,className:e.demoOne,spacing:0,alignItems:"center"},r.a.createElement(g.a,{size:"small",onClick:this.backToMap,style:{marginBottom:"1em"}},"Back To Map"))))}}]),t}(n.Component),Fi=Object(s.b)(function(e){return{beacon:e.beacon,ecg:e.ecg,info:e.info,heartrate:e.heartrate,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},fetchEcgVitals:function(t){return e(et())},fetchHeartrateVitals:function(t){return e(at())},fetchSpecificHeartrateVitals:function(t){return e(nt(t))},fetchSpecificEcgVitals:function(t){return e(tt(t))},signOutUser:function(t){return e(Ye())}}})(Bi),Ui=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"1.5rem",flexGrow:"1"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:{padding:"16px 32px 24px"},demoOne:{padding:"16px 32px 5px"},toggleContainer:{height:56,padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px"),display:"flex",alignItems:"center",justifyContent:"flex-start",margin:"".concat(e.spacing.unit,"px 0")},button:{margin:e.spacing.unit}}})(Fi),Wi="http://137.132.165.139:3000/graphql",qi=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).toggleDrawer=function(){a.setState({drawer:!0})},a.toggleCloseDrawer=function(){a.setState({drawer:!1})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/locationTracking")},a.handleAddAnother=function(e){e.preventDefault(),"Patient"==a.state.type?a.props.history.push("/addPatient"):"Staff"==a.state.type?a.props.history.push("/addStaff"):a.props.history.push("/addAsset")},a.handleToMap=function(e){e.preventDefault(),a.load(a.state.ward),a.state.edit&&a.props.editPatient(""),a.props.history.push("/locationTracking")},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(Wi),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.load=function(e){var t='\n      query {\n        map (id: "'.concat(e,'") {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    ');a.request({query:t}).then(function(e){a.props.loadMap(e.data.data.map)})},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){a.setState(Object(J.a)({},e,t.target.value))}},a.handleTabChange=function(e,t){a.setState({tab:t})},a.handleLogOut=function(){a.handleClose(),a.props.signOutUser()},a.imageUpload=function(e){if(e.target.files[0]){var t=e.target.files[0];a.setState({image:t}),a.setState({imagePreview:URL.createObjectURL(e.target.files[0])}),a.setState({imageName:t.name})}},a.removeImage=function(){a.setState({image:""}),a.setState({imagePreview:""}),a.setState({imageName:""})},a.cancel=function(){a.props.history.push("/home")},a.renderInformation=function(){var e=[];if("Patient"==a.state.type|"Staff"==a.state.type){if(""!=a.state.age&&e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:4,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"Age:")),r.a.createElement(S.a,{item:!0,xs:8,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},a.state.age))),r.a.createElement(X.a,{variant:"middle"}))),""!=a.state.gender){var t="";t="male"==a.state.gender?"Male":"Female",e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:4,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"Gender:")),r.a.createElement(S.a,{item:!0,xs:8,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},t))),r.a.createElement(X.a,{variant:"middle"})))}""!=a.state.race&&e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:4,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"Race:")),r.a.createElement(S.a,{item:!0,xs:8,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},a.state.race))),r.a.createElement(X.a,{variant:"middle"})))}else"Asset"==a.state.type&&""!=a.state.owner&&e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:4,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"Owner:")),r.a.createElement(S.a,{item:!0,xs:8,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},a.state.owner))),r.a.createElement(X.a,{variant:"middle"})));if("Patient"==a.state.type){var n="";null!=a.state.devices&&"None"!=a.state.devices[0]&&(a.state.devices.map(function(e){n+="".concat(e.id," ")}),e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:4,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"Devices:")),r.a.createElement(S.a,{item:!0,xs:8,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},n))),r.a.createElement(X.a,{variant:"middle"}))))}return 0==e.length&&e.push(r.a.createElement("div",null,r.a.createElement(te.a,null,r.a.createElement(S.a,{item:!0,xs:12,style:{textAlign:"center"}},r.a.createElement(C.a,{variant:"body1"},"-None-"))))),e},a.state={anchorEl:null,auth:!0,name:"Santa Claus",owner:"",image:"",imagePreview:"",imageName:"",ward:"Ward 52",tab:0,type:"",beacon:"b30",edit:!1,age:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){null==this.props.confirmType?this.props.history.push("/home"):null==this.props.confirmType.confirm||(this.setState({name:this.props.confirmType.confirm.name}),this.setState({ward:this.props.confirmType.confirm.ward}),this.setState({type:this.props.confirmType.confirm.type}),this.setState({beacon:this.props.confirmType.confirm.beacon}),"Patient"==this.props.confirmType.confirm.type|"Staff"==this.props.confirmType.confirm.type&&(this.setState({age:this.props.confirmType.confirm.age}),this.setState({race:this.props.confirmType.confirm.race}),this.setState({gender:this.props.confirmType.confirm.gender})),"Asset"==this.props.confirmType.confirm.type&&this.setState({owner:this.props.confirmType.confirm.owner}),"Patient"==this.props.confirmType.confirm.type&&this.setState({devices:this.props.confirmType.confirm.devices})),""!=this.props.edit&&this.setState({edit:!0})}},{key:"componentDidUpdate",value:function(){0==this.props.isAuthenticating&&0==this.props.authenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.anchorEl,i=a.auth,o=Boolean(n);return r.a.createElement("div",{className:t.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:t.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:t.grow,style:{color:"black"}},this.state.edit?"Edit":"Add"," ",this.state.type),i&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":o?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:o,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleLogOut},"Logout"))))),r.a.createElement(fe.a,{onClickAway:this.toggleCloseDrawer},r.a.createElement(ve,{toggle:this.state.drawer})),r.a.createElement(S.a,{container:!0,justify:"center"},r.a.createElement(S.a,{container:!0,className:t.demo,justify:"center",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"h5",style:{marginBottom:"2em"},gutterBottom:!0},this.state.type," Successfully ",this.state.edit?"Edited":"Added","!"),r.a.createElement(I.a,{style:{marginTop:"2em",width:"min-content",margin:"auto"}},r.a.createElement(R.a,{style:{paddingBottom:"5px",paddingTop:"5px",textAlign:"center"}},r.a.createElement(S.a,{container:!0,style:{alignItems:"center"}},r.a.createElement(S.a,{item:!0,xs:12,style:{minWidth:"300px"}},r.a.createElement(gt.a,{style:{margin:"auto",marginTop:"1em",backgroundColor:"orange"}},"Patient"==this.state.type?r.a.createElement("i",{className:"fas fa-user-injured"}):null,"Asset"==this.state.type?r.a.createElement("i",{className:"fas fa-laptop-medical"}):null,"Staff"==this.state.type?r.a.createElement("i",{className:"fas fa-user-md"}):null),r.a.createElement(C.a,{variant:"h5",style:{marginTop:"0.5em"}},this.state.name)),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(C.a,{className:t.pos,color:"textSecondary"},this.state.ward),r.a.createElement(pa.a,{icon:r.a.createElement(pe.a,null),label:""!=this.state.beacon?this.state.beacon[0]:"Unassigned",className:t.chip,variant:"outlined",style:{marginTop:"1em"}}),r.a.createElement(X.a,{variant:"middle",style:{marginTop:"1em"}})),r.a.createElement(S.a,{item:!0,xs:12,style:{textAlign:"left",marginTop:"1em",marginLeft:"1em"}},r.a.createElement(C.a,{color:"textSecondary"},"Information")),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement($.a,null,this.renderInformation())))))),r.a.createElement(S.a,{item:!0,xs:6,style:{textAlign:"center",paddingTop:"2em"}},this.state.edit?"":r.a.createElement(g.a,{variant:"outlined",onClick:function(t){return e.handleAddAnother(t)}},"Add Another ",this.state.type)),r.a.createElement(S.a,{item:!0,xs:6,style:{textAlign:"center",paddingTop:"2em"}},r.a.createElement(g.a,{variant:"outlined",onClick:this.handleToMap},"Map: ",this.state.ward)))))}}]),t}(n.Component),zi=Object(s.b)(function(e){return{confirmType:e.confirmType,edit:e.edit,isAuthenticating:e.isAuthenticating,authenticated:e.authenticated}},function(e){return{addUsername:function(t){return e(Be(t))},editPatient:function(t){return e(qe(t))},loadMap:function(t){return e(He(t))},signOutUser:function(t){return e(Ye())}}})(qi),Hi=Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"1.5rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},label:{textTransform:"capitalize"},cameraIcon:{opacity:"0.5",paddingLeft:"10px"},cardContent:{paddingBottom:"16px"},demo:{padding:"16px 32px 24px",width:"auto"},demoOne:{padding:"16px 32px 5px"}}})(zi),Gi="http://137.132.165.139:3000/graphql";var Vi=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).createOptions=function(e){var t=e.map(function(e){return{value:e.id,label:e.id}});a.setState({options:t})},a.fetch=function(e){a.request({query:"\n      query {\n        maps {\n          id\n          scale\n          coordinates\n          imageURL\n          navMesh\n          navPath\n          pois\n        }\n      }\n    "}).then(function(e){a.props.fetchMaps(e.data.data.maps),a.createOptions(e.data.data.maps)})},a.request=function(e){var t=e.query,a=e.variables;return Re()({method:"post",url:"".concat(Gi),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.toggleDrawer=function(){a.setState({drawer:!0})},a.handleMenu=function(e){a.setState({drawer:!1}),a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.packageDevice=function(){var e={};return""!=a.state.id&&(e.device={id:a.state.id,type:"mobile"}),""!=a.state.beaconId&&(e.device={id:a.state.beaconId}),""!=a.state.gattId&&(e.gatt={id:a.state.gattId},""!=a.state.gattProfile&&(e.gatt.profile=JSON.parse(a.state.gattProfile))),e},a.createDevice=function(e){var t={input:e};a.requestPost({query:"\n        mutation ($input: CreateDeviceInput!) {\n          createDevice(input: $input) { id }\n        }\n      ",variables:t})},a.requestPost=function(e){var t=e.query,a=e.variables;Re()({method:"post",url:"".concat("http://137.132.165.139:3000/graphql"),headers:{"Content-Type":"application/json"},data:JSON.stringify({query:t,variables:a})})},a.handleSubmit=function(e){e.preventDefault();a.state.type;var t=a.packageDevice();a.createDevice(t)},a.handleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleChange=function(e){return function(t){"ward"==e?a.setState(Object(J.a)({},e,t)):a.setState(Object(J.a)({},e,t.target.value))}},a.cancel=function(){a.props.history.push("/home")},a._scan=function(e){e.preventDefault(),a.setState({scanning:!a.state.scanning})},a._onDetected=function(e){a.state.results.indexOf(e)<0&&a.setState({results:a.state.results.concat([e])})},a.state={anchorEl:null,auth:!0,id:"",beaconId:"",measuredPower:"",gattId:"",gattProfile:"",beacon:a.props.beacon,scanning:!1,results:[],options:[],edit:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.fetch(),""!=this.props.edit&&null!=this.props.edit){var e=this.props.edit;this.setState({name:e.name,age:e.age,race:e.race,gender:e.gender,ward:{value:e.ward,label:e.ward},edit:!0})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=(t.theme,this.state),i=n.anchorEl,o=n.auth,s=Boolean(i);return r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{position:"static",style:{boxShadow:"none",backgroundColor:"white"}},r.a.createElement(O.a,null,r.a.createElement(T.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},r.a.createElement(D.a,null)),r.a.createElement(C.a,{variant:"title",className:a.grow,style:{color:"black"}},this.state.edit?"Edit":"Add"," Device"),o&&r.a.createElement("div",null,r.a.createElement(T.a,{"aria-owns":s?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(W.a,{style:{color:"black"}})),r.a.createElement(V.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:s,onClose:this.handleClose},r.a.createElement(H.a,{onClick:this.handleClose},"Logout"))))),r.a.createElement(ve,{toggle:this.state.drawer}),r.a.createElement("form",{className:a.align},r.a.createElement(S.a,{container:!0,direction:"column",spacing:0,alignItems:"center",style:{minHeight:"75vh"}},r.a.createElement(S.a,{item:!0,xs:12,lg:5},r.a.createElement("div",{className:a.layout},r.a.createElement(C.a,{variant:"h4",gutterBottom:!0},"Device"),r.a.createElement(C.a,{variant:"h6",gutterBottom:!0},"Barcode Scan"),r.a.createElement(g.a,{variant:"outlined",onClick:this._scan},this.state.scanning?"Stop":"Start"),r.a.createElement("ul",{className:"results"},this.state.results.map(function(e){return r.a.createElement(la,{key:e.codeResult.code,result:e})})),this.state.scanning?r.a.createElement(ca,{onDetected:this._onDetected}):null,r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"id",placeholder:"id",variant:"outlined",value:this.state.id,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({id:t.target.value})}}))),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Beacon ID",placeholder:"Beacon ID",variant:"outlined",value:this.state.beaconId,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({beaconId:t.target.value})}})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Measured Power",placeholder:"Measured Power",variant:"outlined",value:this.state.measuredPower,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({measuredPower:t.target.value})}})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Gatt ID",placeholder:"Gatt ID",variant:"outlined",value:this.state.gattId,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({gattId:t.target.value})}})),r.a.createElement(dt.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(ct.a,{label:"Gatt Profile",placeholder:"Gatt Profile",variant:"outlined",value:this.state.gattProfile,fullWidth:!0,className:a.textField,onChange:function(t){return e.setState({gattProfile:t.target.value})}})),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center",paddingTop:"1rem"}},r.a.createElement(g.a,{variant:"contained",color:"primary",onClick:function(t){return e.handleSubmit(t)}},"Submit"),r.a.createElement(g.a,{style:{marginLeft:"3em"},onClick:this.cancel},"Cancel"))))))}}]),t}(n.Component),Ji=Object(s.b)(function(e){return{beacon:e.beacon,maps:e.maps,edit:e.edit}},function(e){return{confirmType:function(t){return e(We(t))},addPatient:function(t){return e(Je(t))},editPatient:function(t){return e(qe(t))},removePatient:function(t){return e(Ze(t))},fetchMaps:function(t){return e(ze(t))}}})(Vi),Zi=(Object(q.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},grow:{flexGrow:1},card:{minWidth:275,padding:"2rem"},textField:{},borderBox:{border:"1px solid",padding:"2rem",borderRadius:"16px"},menu:{width:200},menuButton:{marginLeft:-12,marginRight:20,opacity:.4,color:"black"},align:{padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",padding:"18.5px 14px"},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16,padding:"18.5px 14px"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0}}},{withTheme:!0})(Ji),function(){return r.a.createElement(m.a,null,r.a.createElement(h.a,{path:"/",exact:!0,component:Tt}),r.a.createElement(h.a,{path:"/home",exact:!0,component:ot}),r.a.createElement(h.a,{path:"/addPatient",exact:!0,component:Xa}),r.a.createElement(h.a,{path:"/editPatient",exact:!0,component:Xa}),r.a.createElement(h.a,{path:"/addAsset",exact:!0,component:un}),r.a.createElement(h.a,{path:"/addStaff",exact:!0,component:gn}),r.a.createElement(h.a,{path:"/locationTracking",exact:!0,component:mr}),r.a.createElement(h.a,{path:"/contactTracing",exact:!0,component:gr}),r.a.createElement(h.a,{path:"/contactTracingResults",exact:!0,component:Rr}),r.a.createElement(h.a,{path:"/patientInfo",exact:!0,component:_i}),r.a.createElement(h.a,{path:"/staffInfo",exact:!0,component:Ui}),r.a.createElement(h.a,{path:"/assetInfo",exact:!0,component:Ui}),r.a.createElement(h.a,{path:"/addConfirmation",exact:!0,component:Hi}))}),Yi=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={page:"Login"},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Zi,null))}}]),t}(n.Component),Qi=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function $i(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Ki,Xi,eo,to=a(950),ao=a(186),no=a(232),ro=a(231),io=a.n(ro),oo={username:{username:"staff"},confirmType:{type:"Patient"},assets:[],staff:[],patients:[],contactTrace:[],edit:"",maps:[],map:"",devices:[],deviceLogs:[],ecg:{},heartrate:{},simulation:"",info:"",fetching:!1,traceDetails:[],filterTrace:[],beaconCounter:""},so=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"READ_PATIENTS":return Object(jt.a)({},e,{patients:t.payload.map(function(t){return e.patients.forEach(function(e){e.id==t.id&&(t.highlight=e.highlight)}),t})});case"READ_ASSETS":return Object(jt.a)({},e,{assets:t.payload.map(function(t){return e.assets.forEach(function(e){e.id==t.id&&(t.highlight=e.highlight)}),t})});case"READ_STAFF":return Object(jt.a)({},e,{staff:t.payload.map(function(t){return e.staff.forEach(function(e){e.id==t.id&&(t.highlight=e.highlight)}),t})});case"AUTH_USER":return Object(jt.a)({},e,{authenticated:!0,autherror:null,isAuthenticating:!1});case"SIGN_OUT_USER":return Object(jt.a)({},e,{authenticated:!1,autherror:null,isAuthenticating:!1});case"AUTH_ERROR":return Object(jt.a)({},e,{authenticated:!1,autherror:t.payload.message,isAuthenticating:!1});case"ADD_USERNAME":return Object(jt.a)({},e,{username:t.payload});case"ASSIGN_BEACON":return Object(jt.a)({},e,{beacon:t.payload});case"ASSIGN_DEVICES":return Object(jt.a)({},e,{assignDevices:t.payload});case"CONFIRM_TYPE":return Object(jt.a)({},e,{confirmType:t.payload});case"ADD_PATIENT":return Object(jt.a)({},e,{patients:[].concat(Object(no.a)(e.patients),[t.payload])});case"EDIT_PATIENT":return Object(jt.a)({},e,{edit:t.payload});case"REMOVE_PATIENT":return Object(jt.a)({},e,{patients:e.patients.filter(function(e){return e!==t.payload})});case"ADD_STAFF":return Object(jt.a)({},e,{staff:[].concat(Object(no.a)(e.staff),[t.payload])});case"REMOVE_STAFF":return Object(jt.a)({},e,{staff:e.staff.filter(function(e){return e!==t.payload})});case"ADD_ASSET":return Object(jt.a)({},e,{assets:[].concat(Object(no.a)(e.assets),[t.payload])});case"REMOVE_ASSET":return Object(jt.a)({},e,{assets:e.assets.filter(function(e){return e!==t.payload})});case"FETCH_MAPS":return Object(jt.a)({},e,{maps:t.payload});case"LOAD_MAP":return Object(jt.a)({},e,{map:t.payload});case"FETCH_DEVICES":return Object(jt.a)({},e,{devices:t.payload});case"FETCH_DEVICE_LOCATIONS":return Object(jt.a)({},e,{deviceLogs:t.payload.aggregations.id.buckets.map(function(e){return e.latest.hits.hits[0]._source})});case"FETCH_ECG_VITALS":return Object(jt.a)({},e,{ecg:t.payload});case"FETCH_SIMULATION_COORDINATES":return Object(jt.a)({},e,{simulation:t.payload});case"FETCH_HEARTRATE_VITALS":return Object(jt.a)({},e,{heartrate:t.payload});case"LOAD_INFO":return Object(jt.a)({},e,{info:t.payload});case"FETCH_CONTACT_TRACE":return Object(jt.a)({},e,{contactTrace:t.payload});case"FETCHING_PROCESS":return Object(jt.a)({},e,{fetching:!0});case"FETCHING_DONE":return Object(jt.a)({},e,{fetching:!1});case"UPDATE_TRACE_DETAILS":return Object(jt.a)({},e,{traceDetails:t.payload});case"FETCH_FILTER_TRACE":return Object(jt.a)({},e,{filterTrace:t.payload});case"FETCH_NEW_BEACON":return Object(jt.a)({},e,{beaconCounter:t.payload});case"FETCH_PATIENT_COUNT":return Object(jt.a)({},e,{patientCounter:t.payload});case"FETCH_ASSET_COUNT":return Object(jt.a)({},e,{assetCounter:t.payload});case"FETCH_STAFF_COUNT":return Object(jt.a)({},e,{staffCounter:t.payload});case"UPDATE_PATIENT":return Object(jt.a)({},e,{patients:e.patients.map(function(e){return e.id===t.payload.id?t.payload:e})});case"UPDATE_STAFF":return Object(jt.a)({},e,{staff:e.staff.map(function(e){return e.id===t.payload.id?t.payload:e})});case"UPDATE_ASSET":return Object(jt.a)({},e,{assets:e.assets.map(function(e){return e.id===t.payload.id?t.payload:e})});case"HIGHLIGHT_PATIENT":return io()(e,{patients:Object(J.a)({},t.payload.index,{highlight:{$set:t.payload.highlight}})});case"HIGHLIGHT_ASSET":return io()(e,{assets:Object(J.a)({},t.payload.index,{highlight:{$set:t.payload.highlight}})});case"HIGHLIGHT_STAFF":return io()(e,{staff:Object(J.a)({},t.payload.index,{highlight:{$set:t.payload.highlight}})});default:return e}},co=a(443),lo=Object(ao.c)(so,{username:null,confirmType:null,authenticated:!1,isAuthenticating:!0,autherror:null,assets:[],staff:[],patients:[],edit:"",maps:[],map:"",devices:[],deviceLogs:[],vitals:{},info:"",beaconCounter:"",assetCounter:"",patientCounter:"",staffCounter:"",fetching:!1,simulation:""},Object(ao.a)(co.a));lo.dispatch(Qe()),lo.dispatch((Ki=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ke.database().ref().child("patients").on("value",function(e){var a=[],n=e.val();for(var r in n){var i=n[r];i.id=r,a.push(i)}t({type:"READ_PATIENTS",payload:a})});case 1:case"end":return e.stop()}},e)})),function(e){return Ki.apply(this,arguments)})),lo.dispatch((Xi=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ke.database().ref().child("assets").on("value",function(e){var a=[],n=e.val();for(var r in n){var i=n[r];i.id=r,a.push(i)}t({type:"READ_ASSETS",payload:a})});case 1:case"end":return e.stop()}},e)})),function(e){return Xi.apply(this,arguments)})),lo.dispatch((eo=Object(we.a)(Se.a.mark(function e(t){return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ke.database().ref().child("staff").on("value",function(e){var a=[],n=e.val();for(var r in n){var i=n[r];i.id=r,a.push(i)}t({type:"READ_STAFF",payload:a})});case 1:case"end":return e.stop()}},e)})),function(e){return eo.apply(this,arguments)}));var uo=lo;o.a.render(r.a.createElement(s.a,{store:uo},r.a.createElement(to.a,null,r.a.createElement(Yi,null))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/medicalWebsite",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/medicalWebsite","/service-worker.js");Qi?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):$i(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):$i(e)})}}()}},[[447,2,1]]]);
//# sourceMappingURL=main.3aa3d592.chunk.js.map